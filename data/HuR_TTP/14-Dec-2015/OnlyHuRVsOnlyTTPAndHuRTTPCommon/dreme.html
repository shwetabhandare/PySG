<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<title>DREME</title>
<style type="text/css">
    
    /* START INCLUDED FILE "meme.css" */
        /* The following is the content of meme.css */
        body { background-color:white; font-size: 12px; font-family: Verdana, Arial, Helvetica, sans-serif;}

        div.help {
          display: inline-block;
          margin: 0px;
          padding: 0px;
          width: 12px;
          height: 13px;
          cursor: pointer;
          background-image: url(data:image/gif;base64,R0lGODlhDAANAIABANR0AP///yH5BAEAAAEALAAAAAAMAA0AAAIdhI8Xy22MIFgv1DttrrJ7mlGNNo4c+aFg6SQuUAAAOw==);
        }

        div.help:hover {
          background-image: url(data:image/gif;base64,R0lGODlhDAANAKEAANR0AP///9R0ANR0ACH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEAAAIALAAAAAAMAA0AAAIdDGynCe3PgoxONntvwqz2/z2K2ImjR0KhmSIZUgAAOw==);
        }
        
        p.spaced { line-height: 1.8em;}
        
        span.citation { font-family: "Book Antiqua", "Palatino Linotype", serif; color: #004a4d;}

        p.pad { padding-left: 30px; padding-top: 5px; padding-bottom: 10px;}

        td.jump { font-size: 13px; color: #ffffff; background-color: #00666a;
          font-family: Georgia, "Times New Roman", Times, serif;}

        a.jump { margin: 15px 0 0; font-style: normal; font-variant: small-caps;
          font-weight: bolder; font-family: Georgia, "Times New Roman", Times, serif;}

        h2.mainh {font-size: 1.5em; font-style: normal; margin: 15px 0 0;
          font-variant: small-caps; font-family: Georgia, "Times New Roman", Times, serif;}

        h2.line {border-bottom: 1px solid #CCCCCC; font-size: 1.5em; font-style: normal;
          margin: 15px 0 0; padding-bottom: 3px; font-variant: small-caps;
          font-family: Georgia, "Times New Roman", Times, serif;}

        h4 {border-bottom: 1px solid #CCCCCC; font-size: 1.2em; font-style: normal;
          margin: 10px 0 0; padding-bottom: 3px; font-family: Georgia, "Times New Roman", Times, serif;}

        h5 {margin: 0px}

        a.help { font-size: 9px; font-style: normal; text-transform: uppercase;
          font-family: Georgia, "Times New Roman", Times, serif;}

        div.pad { padding-left: 30px; padding-top: 5px; padding-bottom: 10px;}
        
        div.pad1 { margin: 10px 5px;}

        div.pad2 { margin: 25px 5px 5px;}
        h2.pad2 { padding: 25px 5px 5px;}

        div.pad3 { padding: 5px 0px 10px 30px;}

        div.box { border: 2px solid #CCCCCC; padding:10px; overflow: hidden;}

        div.bar { border-left: 7px solid #00666a; padding:5px; margin-top:25px; }

        div.subsection {margin:25px 0px;}

        img {border:0px none;}

        th.majorth {text-align:left;}
        th.minorth {font-weight:normal; text-align:left; width:8em; padding: 3px 0px;}
        th.actionth {font-weight:normal; text-align:left;}

        .block_td {height:25px;}
        .block_container {position:relative; width:98%; height:25px; padding:0px; margin: 0px 0px 0px 1em;}
        .block_motif {position:absolute; z-index:3; height:12px; top:0px; text-align:center; vertical-align:middle; background-color:cyan;}
        .block_rule {position:absolute; z-index:2; width:100%; height:1px; top:12px; left:0px; background-color:gray;}
        .block_plus_sym {position:absolute; z-index:4; line-height:12px; top:0px; left:-1em;}
        .block_minus_sym {position:absolute; z-index:4; line-height:12px; top:13px; left:-1em;}

        .tic_major {position:absolute; border-left:2px solid blue; height:0.5em; top:0em;}
        .tic_minor {position:absolute; border-left:1px solid blue; height:0.2em; top:0em;}
        .tic_label {position:absolute; top:0.5em;  height: 1em; text-align:center; vertical-align:middle}

        .explain h5 {font-size:1em; margin-left: 1em;}

        div.doc {margin-left: 2em; margin-bottom: 3em;}
        
        th.trainingset {
          border-bottom: thin dashed black; 
          font-weight:normal; 
          padding:0px 10px;
        }
        .dnaseq {
          font-weight: bold; 
          font-size: large; 
          font-family: 'Courier New', Courier, monospace;
        }
        .dna_A {
          color: rgb(204,0,0);
        }
        .dna_C {
          color: rgb(0,0,204);
        }
        .dna_G {
          color: rgb(255,179,0);
        }
        .dna_T {
          color: rgb(0,128,0);
        }
        div.pop_content {
          position:absolute;
          z-index:50;
          width:300px;
          padding: 5px;
          background: #E4ECEC;
          font-size: 12px;
          font-family: Arial;
          border-style: double;
          border-width: 3px;
          border-color: #AA2244;
          display:none;
        }
        div.pop_content > div.pop_close {
          float:right;
          bottom:0px;
        }
/*****************************************************************************
 * Program logo styling
 ****************************************************************************/
div.prog_logo {
  border-bottom: 0.25em solid #0f5f60;
  height: 4.5em;
  width: 24em;
  display:inline-block;
}
div.prog_logo img {
  float:left;
  width: 4em;
  border-style: none;
  margin-right: 0.2em;
}
div.prog_logo h1, div.prog_logo h1:hover, div.prog_logo h1:active, div.prog_logo h1:visited {
  margin:0;
  padding:0;
  font-family: Arial, Helvetica,  sans-serif;
  font-size: 3.2em;
  line-height: 1em;
  vertical-align: top;
  display: block;
  color: #026666;
  letter-spacing: -0.06em;
  text-shadow: 0.04em 0.06em 0.05em #666;
}
div.prog_logo h2, div.prog_logo h2:hover, div.prog_logo h2:active, div.prog_logo h2:visited {
  display: block;
  margin:0;
  padding:0;
  font-family: Helvetica, sans-serif;
  font-size: 0.9em;
  line-height: 1em;
  letter-spacing: -0.06em;
  color: black;
}

div.big.prog_logo {
  font-size: 18px;
}

    /* END INCLUDED FILE "meme.css" */
    
  
    
    /* START INCLUDED FILE "dreme-to-html.css" */
      table.dreme_motifs tr th, table.dreme_motifs tr td {
        padding: 0px 10px;
      }

      div.popup_wrapper {
        position:fixed; 
        z-index:2;
        width:100%; 
        height:0; 
        top:50%; 
        left:0;
      }

      div.popup {
        width: 400px; 
        z-index:2;
        margin-left: auto;
        margin-right: auto;
        padding: 5px;
        background: #FFF;
        border-style: double;
        border-width: 5px;
        border-color: #00666a;
        position:relative; 
      }

      div.grey_background {
        position:fixed; 
        z-index: 1;
        background-color: #000;
        -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
        filter: alpha(opacity=50);
        opacity: 0.5;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;

      }
      td.symaction {
        text-align: center;
      }
      *.symaction {
        font-size: 20px;
      }

      div.close {
        cursor: pointer;
        border: 1px solid black; 
        width:15px; 
        height:15px; 
        line-height:15px; /* this causes vertical centering */
        text-align:center; 
        background-color:#FFF; 
        color:#000; 
        font-size:15px;
        font-family:monospace;
      }

      div.close:hover {
        color:#FFF;
        background-color:#000; 
      }

      div.navnum {
        width:100%; 
        height:20px; 
        line-height:20px; 
        text-align:center; 
        font-size:medium;
      }

      a.navarrow {
        font-size: 30px;
        text-decoration:none;
      }

      a.inactive {
        color:#CCC;
      }

      div.actionbutton { 
        cursor: pointer;
        font-size: 18px;
        line-height:20px; 
        padding: 5px; 
        margin: 10px 0; 
        border: 1px solid black;
      }

      div.actionbutton:hover {
        color:#FFF;
        background-color:#000;
      }

      div.pop_content {
        position:absolute;
        z-index:1;
        width:300px;
        padding: 5px;
        background: #E4ECEC;
        font-size: 12px;
        font-family: Arial;
        border-style: double;
        border-width: 3px;
        border-color: #AA2244;
        display:none;
      }
      span.sort_dir {
        text-decoration: none;
      }

      div.section_title {
        font-weight: bold;
        cursor: pointer;
      }

      div.section_title.inactive {
        color: #000;
      }

      div.section_title.inactive:hover {
        color: #000;
        text-decoration:underline;
      }

      div.section_title label {
        cursor: pointer;
      }

      span.ellipsis {
        display: inline-block;
        border: 1px solid black;
        padding: 0 2px;
        margin: 0 2px;
      }

      div.section_title.inactive:hover span.ellipsis {
        color: #FFF;
        background-color: #000;
      }

      div.section_title.inactive span.toggle {
        color: #000;
      }

      div.section_data {
        margin-left: 20px;
      }
      tr.rule td, tr.rule th {
        border-bottom: 1px solid #CCC;
      }

      h1.compact, h2.compact, h3.compact, h4.compact, h5.compact, h6.compact {
        margin:0; 
        padding:0;
      }

      ul.programs {
        margin-top: 0;
        padding-top: 0;
        margin-bottom: 0;
        padding-bottom: 0;
        margin-left: 0;
        padding-left: 0;
        list-style: none;
        border-bottom: 1px solid black;
      }

      ul.programs li {
        border: 1px solid black;
        border-bottom-width: 0;
        background-color: #EFE;
        cursor: default;
      }

      ul.programs li.active {
        background-color: #CFC;
      }

      ul.programs li.selected {
        background-color: #262;
        color: #FFF;
      }

      div.programs_scroll {
        width: 100%; 
        height: 90px; 
        overflow-y: auto; 
        overflow-x: hidden;
        margin: 0 auto; 
      }
        
      div.tabArea {
        font-size: 80%;
        font-weight: bold;
      }

      a.tab {
        background-color: #ddddff;
        border: 1px solid #000000;
        padding: 2px 1em 2px 1em;
        text-decoration: none;
      }
      div.tabArea.base a.tab {
        border-top-width: 0px;
      }
      div.tabArea.top a.tab {
        border-bottom-width: 0px;
      }

      a.tab, a.tab:visited {
        color: #808080;
      }

      a.tab:hover {
        background-color: #d0d0d0;
        color: #606060;
      }
      a.tab.activeTab, a.tab.activeTab:hover, a.tab.activeTab:visited {
        background-color: #f0f0f0;
        color: #000000;
      }
      div.tabMain {
        border: 1px solid #000000;
        background-color: #ffffff;
        padding: 5px;
        margin-right: 5px;
      }
    /* END INCLUDED FILE "dreme-to-html.css" */
    
  </style>
<script type="text/javascript">
      var pos_count = 3206;
      var neg_count = 4628;
      var motif_seqs = [];
      motif_seqs[1] = ["m01", "AVAAMAA", "TTKTTBT", 7, 2062, 1737, 618, 4.0e-332, 3.0e-326, 3.0e-284, [["AAAAAAA", 923, 279, 6.5e-167, 4.9e-161], ["AAAACAA", 361, 54, 4.3e-089, 3.2e-083], ["AGAAAAA", 554, 213, 2.4e-076, 1.8e-070], ["ACAAAAA", 310, 77, 9.6e-059, 7.2e-053], ["AGAACAA", 60, 15, 4.3e-012, 3.2e-006], ["ACAACAA", 35, 10, 5.0e-007, 3.7e-001]]];
      motif_seqs[2] = ["m02", "BWVAAAA", "TTTTBWV", 7, 1820, 1401, 836, 8.9e-134, 5.6e-128, 1.9e-309, [["TAAAAAA", 320, 190, 8.2e-025, 5.2e-019], ["TTAAAAA", 420, 294, 4.0e-024, 2.5e-018], ["GAGAAAA", 110, 30, 5.4e-020, 3.4e-014], ["TTGAAAA", 132, 48, 5.0e-019, 3.2e-013], ["GTAAAAA", 156, 68, 1.2e-018, 7.5e-013], ["TTCAAAA", 117, 43, 7.6e-017, 4.8e-011], ["CTGAAAA", 77, 20, 8.1e-015, 5.2e-009], ["CAGAAAA", 45, 5, 4.9e-013, 3.1e-007], ["GAAAAAA", 105, 46, 6.9e-013, 4.4e-007], ["TACAAAA", 81, 28, 1.1e-012, 7.0e-007], ["GTCAAAA", 40, 7, 4.8e-010, 3.1e-004], ["CAAAAAA", 60, 21, 1.2e-009, 7.8e-004], ["GACAAAA", 42, 10, 4.4e-009, 2.8e-003], ["CTCAAAA", 54, 20, 2.0e-008, 1.3e-002], ["GTGAAAA", 70, 36, 1.3e-007, 8.4e-002], ["TAGAAAA", 108, 83, 7.6e-006, 4.8e+000], ["CTAAAAA", 90, 67, 2.1e-005, 1.3e+001], ["CACAAAA", 35, 25, 4.7e-003, 3.0e+003]]];
      motif_seqs[3] = ["m03", "AARCANW", "WNTGYTT", 7, 762, 666, 210, 2.3e-111, 1.2e-105, 5.6e-212, [["AAGCAAA", 85, 9, 5.9e-024, 3.1e-018], ["AAACAGA", 71, 9, 4.3e-019, 2.2e-013], ["AAGCATT", 45, 5, 4.9e-013, 2.5e-007], ["AAACATT", 101, 45, 3.2e-012, 1.7e-006], ["AAACAAA", 83, 33, 1.7e-011, 9.0e-006], ["AAACAGT", 47, 11, 4.1e-010, 2.2e-004], ["AAGCAAT", 37, 7, 4.4e-009, 2.3e-003], ["AAACATA", 68, 32, 3.4e-008, 1.8e-002], ["AAACAAT", 55, 22, 5.1e-008, 2.7e-002], ["AAGCAGA", 33, 7, 7.9e-008, 4.2e-002], ["AAGCACA", 18, 1, 1.2e-006, 6.2e-001], ["AAACACA", 39, 14, 1.4e-006, 7.1e-001], ["AAACACT", 34, 15, 5.0e-005, 2.6e+001], ["AAGCATA", 21, 9, 1.2e-003, 6.3e+002], ["AAGCACT", 14, 4, 1.6e-003, 8.6e+002], ["AAGCAGT", 15, 6, 4.6e-003, 2.4e+003]]];
      motif_seqs[4] = ["m04", "ANSAAAR", "YTTTSNT", 7, 856, 765, 418, 1.3e-071, 6.2e-066, 7.7e-229, [["AAGAAAA", 160, 99, 5.0e-012, 2.4e-006], ["ACCAAAA", 45, 9, 1.6e-010, 7.7e-005], ["ATCAAAG", 32, 3, 5.1e-010, 2.4e-004], ["ATGAAAA", 145, 102, 8.0e-009, 3.8e-003], ["AAGAAAG", 76, 38, 2.1e-008, 9.8e-003], ["AGGAAAA", 106, 72, 3.1e-007, 1.5e-001], ["AACAAAA", 45, 18, 8.5e-007, 4.0e-001], ["AACAAAG", 29, 7, 1.3e-006, 6.3e-001], ["AGGAAAG", 50, 25, 5.4e-006, 2.6e+000], ["AGCAAAA", 32, 11, 8.2e-006, 3.9e+000], ["ATCAAAA", 48, 25, 1.5e-005, 7.0e+000], ["ACGAAAA", 16, 5, 1.1e-003, 5.3e+002], ["AGCAAAG", 13, 3, 1.2e-003, 5.7e+002], ["ACGAAAG", 11, 2, 1.6e-003, 7.8e+002], ["ACCAAAG", 16, 6, 2.5e-003, 1.2e+003], ["ATGAAAG", 49, 42, 8.3e-003, 3.9e+003]]];
      motif_seqs[5] = ["m05", "HTTCWGW", "WCWGAAD", 7, 353, 326, 81, 7.8e-062, 3.3e-056, 2.6e-094, [["TTTCAGT", 38, 7, 2.1e-009, 8.9e-004], ["ATTCAGA", 39, 9, 1.2e-008, 4.9e-003], ["TTTCAGA", 38, 9, 2.3e-008, 9.8e-003], ["TTTCTGT", 38, 9, 2.3e-008, 9.8e-003], ["CTTCAGT", 22, 1, 3.9e-008, 1.7e-002], ["ATTCTGA", 36, 9, 9.2e-008, 3.9e-002], ["TTTCTGA", 29, 6, 4.2e-007, 1.8e-001], ["CTTCAGA", 25, 4, 6.2e-007, 2.6e-001], ["ATTCAGT", 38, 13, 1.1e-006, 4.6e-001], ["CTTCTGT", 20, 5, 7.7e-005, 3.3e+001], ["ATTCTGT", 24, 10, 4.4e-004, 1.9e+002], ["CTTCTGA", 24, 12, 1.6e-003, 6.7e+002]]];
      motif_seqs[6] = ["m06", "TTTGNAW", "WTNCAAA", 7, 304, 288, 102, 1.1e-041, 4.6e-036, 1.2e-063, [["TTTGGAA", 43, 8, 2.0e-010, 7.8e-005], ["TTTGTAA", 57, 18, 5.9e-010, 2.4e-004], ["TTTGCAT", 39, 7, 1.0e-009, 4.0e-004], ["TTTGCAA", 31, 5, 2.7e-008, 1.1e-002], ["TTTGAAA", 40, 17, 7.1e-006, 2.8e+000], ["TTTGAAT", 29, 13, 2.1e-004, 8.2e+001], ["TTTGTAT", 46, 29, 2.7e-004, 1.1e+002], ["TTTGGAT", 19, 6, 3.9e-004, 1.6e+002]]];
      motif_seqs[7] = ["m07", "AADDTCA", "TGAHHTT", 7, 288, 267, 113, 2.0e-032, 7.7e-027, 2.3e-076, [["AAAATCA", 54, 20, 2.0e-008, 7.7e-003], ["AAGTTCA", 26, 4, 2.9e-007, 1.1e-001], ["AATGTCA", 29, 6, 4.2e-007, 1.6e-001], ["AAATTCA", 36, 15, 1.7e-005, 6.3e+000], ["AATTTCA", 58, 36, 3.5e-005, 1.3e+001], ["AAAGTCA", 22, 7, 1.4e-004, 5.3e+001], ["AAGGTCA", 14, 2, 1.7e-004, 6.4e+001], ["AAGATCA", 19, 7, 8.9e-004, 3.4e+002], ["AATATCA", 29, 19, 4.9e-003, 1.9e+003]]];
      motif_seqs[8] = ["m08", "AGACADW", "WHTGTCT", 7, 144, 142, 29, 2.8e-030, 1.0e-024, 6.5e-047, [["AGACAAA", 33, 3, 2.3e-010, 8.2e-005], ["AGACATT", 31, 5, 2.7e-008, 9.6e-003], ["AGACATA", 21, 2, 6.5e-007, 2.3e-001], ["AGACAGT", 22, 6, 5.5e-005, 2.0e+001], ["AGACAAT", 25, 11, 4.9e-004, 1.8e+002], ["AGACAGA", 12, 2, 7.7e-004, 2.8e+002]]];
      motif_seqs[9] = ["m09", "AANWGCA", "TGCWNTT", 7, 166, 163, 37, 1.1e-032, 4.0e-027, 2.3e-062, [["AAATGCA", 39, 7, 1.0e-009, 3.6e-004], ["AAGTGCA", 23, 4, 2.8e-006, 9.8e-001], ["AACAGCA", 16, 1, 6.3e-006, 2.2e+000], ["AATTGCA", 24, 6, 1.4e-005, 5.0e+000], ["AATAGCA", 25, 9, 1.2e-004, 4.1e+001], ["AACTGCA", 17, 5, 5.8e-004, 2.0e+002], ["AAAAGCA", 13, 3, 1.2e-003, 4.3e+002], ["AAGAGCA", 14, 4, 1.6e-003, 5.8e+002]]];
      motif_seqs[10] = ["m10", "DGAAACW", "WGTTTCH", 7, 130, 126, 24, 6.1e-028, 2.1e-022, 1.2e-051, [["AGAAACA", 22, 1, 3.9e-008, 1.3e-002], ["TGAAACT", 25, 4, 6.2e-007, 2.1e-001], ["AGAAACT", 34, 10, 9.6e-007, 3.3e-001], ["GGAAACT", 21, 4, 1.2e-005, 4.2e+000], ["TGAAACA", 15, 3, 2.9e-004, 9.9e+001], ["GGAAACA", 13, 2, 3.6e-004, 1.2e+002]]];
      motif_seqs[11] = ["m11", "CTHHAAG", "CTTDDAG", 7, 156, 151, 43, 3.0e-026, 1.0e-020, 7.3e-030, [["CTTAAAG", 35, 10, 5.0e-007, 1.7e-001], ["CTATAAG", 18, 2, 7.2e-006, 2.4e+000], ["CTCTAAG", 18, 2, 7.2e-006, 2.4e+000], ["CTTCAAG", 14, 3, 5.9e-004, 2.0e+002], ["CTACAAG", 12, 2, 7.7e-004, 2.6e+002], ["CTCCAAG", 12, 2, 7.7e-004, 2.6e+002], ["CTAAAAG", 29, 16, 1.2e-003, 4.0e+002], ["CTCAAAG", 17, 6, 1.4e-003, 4.6e+002]]];
      motif_seqs[12] = ["m12", "HCATTTS", "SAAATGD", 7, 195, 188, 71, 9.2e-026, 3.0e-020, 1.4e-045, [["TCATTTC", 49, 21, 7.4e-007, 2.4e-001], ["TCATTTG", 34, 10, 9.6e-007, 3.1e-001], ["ACATTTC", 48, 21, 1.3e-006, 4.2e-001], ["CCATTTC", 25, 8, 5.0e-005, 1.6e+001], ["ACATTTG", 17, 4, 2.1e-004, 7.0e+001], ["CCATTTG", 21, 9, 1.2e-003, 3.9e+002]]];
      motif_seqs[13] = ["m13", "CWGAGAD", "HTCTCWG", 7, 112, 111, 18, 1.3e-026, 4.2e-021, 7.6e-033, [["CAGAGAT", 19, 0, 4.1e-008, 1.3e-002], ["CAGAGAA", 24, 3, 3.1e-007, 9.7e-002], ["CTGAGAA", 27, 8, 1.4e-005, 4.4e+000], ["CAGAGAG", 12, 0, 2.2e-005, 6.9e+000], ["CTGAGAT", 16, 3, 1.4e-004, 4.4e+001], ["CTGAGAG", 14, 4, 1.6e-003, 5.2e+002]]];
      motif_seqs[14] = ["m14", "CAKDAAG", "CTTHMTG", 7, 116, 115, 28, 2.1e-022, 6.5e-017, 9.2e-035, [["CAGGAAG", 16, 0, 6.1e-007, 1.9e-001], ["CATAAAG", 29, 9, 9.5e-006, 3.0e+000], ["CAGAAAG", 15, 1, 1.5e-005, 4.6e+000], ["CATTAAG", 24, 8, 9.4e-005, 2.9e+001], ["CATGAAG", 16, 3, 1.4e-004, 4.3e+001], ["CAGTAAG", 15, 7, 8.9e-003, 2.8e+003]]];
      motif_seqs[15] = ["m15", "ARTNACA", "TGTNAYT", 7, 205, 198, 95, 5.8e-021, 1.8e-015, 4.6e-041, [["AGTTACA", 25, 4, 6.2e-007, 1.9e-001], ["AATCACA", 24, 5, 4.6e-006, 1.4e+000], ["AGTAACA", 24, 7, 3.8e-005, 1.2e+001], ["AATGACA", 20, 6, 2.0e-004, 6.3e+001], ["AATTACA", 43, 32, 2.9e-003, 8.8e+002], ["AGTGACA", 13, 4, 3.2e-003, 9.7e+002], ["AATAACA", 40, 31, 6.0e-003, 1.8e+003], ["AGTCACA", 15, 7, 8.9e-003, 2.7e+003]]];
      motif_seqs[16] = ["m16", "CTGTDWA", "TWHACAG", 7, 118, 113, 29, 2.5e-021, 7.3e-016, 1.3e-032, [["CTGTATA", 34, 10, 9.6e-007, 2.8e-001], ["CTGTAAA", 30, 8, 1.9e-006, 5.6e-001], ["CTGTTTA", 15, 1, 1.5e-005, 4.3e+000], ["CTGTTAA", 22, 9, 6.8e-004, 2.0e+002], ["CTGTGAA", 7, 0, 1.9e-003, 5.6e+002], ["CTGTGTA", 9, 2, 7.1e-003, 2.1e+003]]];
      motif_seqs[17] = ["m17", "AARTCAD", "HTGAYTT", 7, 114, 112, 33, 2.8e-019, 8.0e-014, 7.5e-062, [["AAATCAA", 31, 6, 9.9e-008, 2.9e-002], ["AAGTCAT", 13, 0, 8.9e-006, 2.6e+000], ["AAATCAG", 17, 5, 5.8e-004, 1.7e+002], ["AAGTCAG", 14, 3, 5.9e-004, 1.7e+002], ["AAGTCAA", 12, 2, 7.7e-004, 2.2e+002], ["AAATCAT", 26, 17, 7.4e-003, 2.2e+003]]];
      motif_seqs[18] = ["m18", "CATTGBW", "WVCAATG", 7, 85, 83, 17, 3.9e-018, 1.1e-012, 3.8e-025, [["CATTGTA", 29, 8, 3.7e-006, 1.0e+000], ["CATTGTT", 15, 2, 7.7e-005, 2.2e+001], ["CATTGGA", 13, 2, 3.6e-004, 1.0e+002], ["CATTGGT", 12, 2, 7.7e-004, 2.2e+002], ["CATTGCA", 9, 2, 7.1e-003, 2.0e+003], ["CATTGCT", 7, 1, 9.8e-003, 2.8e+003]]];
      motif_seqs[19] = ["m19", "ARAACWT", "AWGTTYT", 7, 103, 97, 27, 1.6e-017, 4.3e-012, 2.0e-051, [["AAAACTT", 44, 17, 7.2e-007, 2.0e-001], ["AGAACTT", 22, 3, 1.5e-006, 4.1e-001], ["AAAACAT", 16, 2, 3.5e-005, 9.8e+000], ["AGAACAT", 21, 5, 3.9e-005, 1.1e+001]]];
      motif_seqs[20] = ["m20", "TWCTTGW", "WCAAGWA", 7, 66, 66, 11, 4.1e-016, 1.1e-010, 1.7e-023, [["TACTTGT", 23, 4, 2.8e-006, 7.5e-001], ["TACTTGA", 20, 3, 6.8e-006, 1.9e+000], ["TTCTTGA", 11, 0, 5.3e-005, 1.5e+001], ["TTCTTGT", 12, 4, 6.1e-003, 1.7e+003]]];
      motif_seqs[21] = ["m21", "CTTTSWC", "GWSAAAG", 7, 81, 80, 22, 8.5e-015, 2.3e-009, 3.2e-022, [["CTTTCTC", 42, 14, 2.2e-007, 5.8e-002], ["CTTTGTC", 14, 2, 1.7e-004, 4.5e+001], ["CTTTGAC", 13, 2, 3.6e-004, 9.7e+001], ["CTTTCAC", 12, 4, 6.1e-003, 1.6e+003]]];
      motif_seqs[22] = ["m22", "CATGWDA", "THWCATG", 7, 78, 76, 16, 1.8e-016, 4.7e-011, 5.0e-028, [["CATGAAA", 12, 1, 1.8e-004, 4.7e+001], ["CATGTAA", 17, 4, 2.1e-004, 5.6e+001], ["CATGAGA", 11, 1, 4.0e-004, 1.1e+002], ["CATGATA", 16, 4, 4.3e-004, 1.1e+002], ["CATGTTA", 19, 7, 8.9e-004, 2.4e+002], ["CATGTGA", 7, 0, 1.9e-003, 5.1e+002]]];
      motif_seqs[23] = ["m23", "CTRGAAR", "YTTCYAG", 7, 67, 67, 12, 7.7e-016, 2.0e-010, 5.6e-020, [["CTGGAAA", 25, 2, 2.5e-008, 6.4e-003], ["CTGGAAG", 12, 1, 1.8e-004, 4.6e+001], ["CTAGAAG", 15, 3, 2.9e-004, 7.5e+001], ["CTAGAAA", 15, 6, 4.6e-003, 1.2e+003]]];
      motif_seqs[24] = ["m24", "TRMACAA", "TTGTKYA", 7, 67, 66, 13, 5.9e-015, 1.5e-009, 1.0e-023, [["TAAACAA", 26, 6, 3.5e-006, 9.1e-001], ["TGCACAA", 16, 1, 6.3e-006, 1.6e+000], ["TACACAA", 14, 4, 1.6e-003, 4.3e+002], ["TGAACAA", 11, 3, 4.8e-003, 1.2e+003]]];
      motif_seqs[25] = ["m25", "CTTRAGW", "WCTYAAG", 7, 56, 55, 9, 9.9e-014, 2.5e-008, 1.8e-015, [["CTTAAGT", 25, 5, 2.3e-006, 5.7e-001], ["CTTGAGT", 10, 0, 1.3e-004, 3.3e+001], ["CTTGAGA", 11, 1, 4.0e-004, 1.0e+002], ["CTTAAGA", 16, 7, 5.1e-003, 1.3e+003]]];
      motif_seqs[26] = ["m26", "AAACSAR", "YTSGTTT", 7, 52, 50, 8, 1.1e-012, 2.7e-007, 7.4e-021, [["AAACCAG", 15, 2, 7.7e-005, 1.9e+001], ["AAACGAA", 10, 0, 1.3e-004, 3.3e+001], ["AAACCAA", 18, 5, 3.0e-004, 7.5e+001], ["AAACGAG", 7, 1, 9.8e-003, 2.5e+003]]];
      motif_seqs[27] = ["m27", "CWGATWA", "TWATCWG", 7, 80, 79, 26, 6.9e-013, 1.7e-007, 1.8e-015, [["CTGATAA", 25, 6, 7.1e-006, 1.8e+000], ["CAGATTA", 18, 3, 3.1e-005, 7.7e+000], ["CTGATTA", 15, 5, 2.1e-003, 5.2e+002], ["CAGATAA", 23, 13, 4.5e-003, 1.1e+003]]];
      motif_seqs[28] = ["m28", "CTMTGTW", "WACAKAG", 7, 57, 57, 13, 3.7e-012, 9.0e-007, 1.6e-018, [["CTATGTA", 21, 6, 1.1e-004, 2.6e+001], ["CTCTGTA", 12, 1, 1.8e-004, 4.3e+001], ["CTATGTT", 12, 2, 7.7e-004, 1.9e+002], ["CTCTGTT", 12, 4, 6.1e-003, 1.5e+003]]];
      motif_seqs[29] = ["m29", "ARAYTGG", "CCARTYT", 7, 62, 62, 17, 8.8e-012, 2.1e-006, 1.1e-014, [["AGATTGG", 10, 0, 1.3e-004, 3.2e+001], ["AAATTGG", 31, 14, 1.3e-004, 3.2e+001], ["AAACTGG", 14, 3, 5.9e-004, 1.4e+002], ["AGACTGG", 7, 0, 1.9e-003, 4.6e+002]]];
      motif_seqs[30] = ["m30", "AGAAYCW", "WGRTTCT", 7, 53, 52, 11, 1.2e-011, 2.9e-006, 1.2e-011, [["AGAACCT", 12, 0, 2.2e-005, 5.2e+000], ["AGAACCA", 10, 0, 1.3e-004, 3.1e+001], ["AGAATCA", 17, 4, 2.1e-004, 5.1e+001], ["AGAATCT", 15, 7, 8.9e-003, 2.1e+003]]];
      motif_seqs[31] = ["m31", "CCCWCMC", "GKGWGGG", 7, 60, 56, 14, 2.2e-011, 5.3e-006, 6.7e-007, [["CCCTCAC", 11, 0, 5.3e-005, 1.3e+001], ["CCCTCCC", 22, 7, 1.4e-004, 3.3e+001], ["CCCACCC", 18, 5, 3.0e-004, 7.0e+001], ["CCCACAC", 9, 2, 7.1e-003, 1.7e+003]]];
      motif_seqs[32] = ["m32", "TARCTSA", "TSAGYTA", 7, 58, 56, 15, 6.4e-011, 1.5e-005, 5.9e-014, [["TAACTCA", 21, 6, 1.1e-004, 2.5e+001], ["TAGCTCA", 11, 1, 4.0e-004, 9.3e+001], ["TAACTGA", 15, 5, 2.1e-003, 4.9e+002], ["TAGCTGA", 11, 3, 4.8e-003, 1.1e+003]]];
      motif_seqs[33] = ["m33", "TAAGCTB", "VAGCTTA", 7, 31, 31, 2, 1.7e-010, 3.8e-005, 4.6e-007, [["TAAGCTT", 13, 0, 8.9e-006, 2.0e+000], ["TAAGCTG", 11, 2, 1.6e-003, 3.7e+002], ["TAAGCTC", 7, 0, 1.9e-003, 4.4e+002]]];
      motif_seqs[34] = ["m34", "TAWWGCA", "TGCWWTA", 7, 55, 55, 16, 3.3e-010, 7.6e-005, 4.4e-022, [["TATAGCA", 22, 7, 1.4e-004, 3.2e+001], ["TATTGCA", 16, 5, 1.1e-003, 2.5e+002], ["TAAAGCA", 10, 3, 9.4e-003, 2.1e+003], ["TAATGCA", 7, 1, 9.8e-003, 2.2e+003]]];
      motif_seqs[35] = ["m35", "ACGTDTA", "TAHACGT", 7, 30, 30, 1, 4.0e-011, 8.9e-006, 5.5e-007, [["ACGTATA", 15, 0, 1.5e-006, 3.3e-001], ["ACGTTTA", 8, 0, 7.8e-004, 1.8e+002], ["ACGTGTA", 9, 1, 2.0e-003, 4.5e+002]]];
      motif_seqs[36] = ["m36", "AACHCTG", "CAGDGTT", 7, 34, 34, 4, 5.7e-010, 1.3e-004, 5.2e-010, [["AACACTG", 11, 0, 5.3e-005, 1.2e+001], ["AACCCTG", 9, 0, 3.2e-004, 7.1e+001], ["AACTCTG", 14, 4, 1.6e-003, 3.7e+002]]];
      motif_seqs[37] = ["m37", "VTGGCAW", "WTGCCAB", 7, 56, 56, 10, 1.9e-013, 4.1e-008, 7.1e-013, [["GTGGCAA", 8, 0, 7.8e-004, 1.7e+002], ["CTGGCAA", 11, 2, 1.6e-003, 3.6e+002], ["CTGGCAT", 7, 0, 1.9e-003, 4.2e+002], ["ATGGCAA", 14, 5, 3.9e-003, 8.6e+002], ["ATGGCAT", 9, 2, 7.1e-003, 1.6e+003], ["GTGGCAT", 7, 1, 9.8e-003, 2.2e+003]]];
      motif_seqs[38] = ["m38", "ASTGCWA", "TWGCAST", 7, 40, 40, 5, 2.6e-011, 5.6e-006, 7.0e-013, [["ACTGCTA", 12, 1, 1.8e-004, 3.9e+001], ["AGTGCAA", 10, 1, 9.0e-004, 2.0e+002], ["ACTGCAA", 10, 2, 3.4e-003, 7.5e+002], ["AGTGCTA", 8, 1, 4.5e-003, 9.8e+002]]];
      motif_seqs[39] = ["m39", "CCAANCC", "GGNTTGG", 7, 37, 35, 5, 1.3e-009, 2.7e-004, 1.2e-004, [["CCAAACC", 10, 1, 9.0e-004, 2.0e+002], ["CCAAGCC", 9, 1, 2.0e-003, 4.4e+002], ["CCAACCC", 9, 2, 7.1e-003, 1.5e+003], ["CCAATCC", 7, 1, 9.8e-003, 2.1e+003]]];
      motif_seqs[40] = ["m40", "CAARTTK", "MAAYTTG", 7, 72, 70, 27, 3.6e-010, 7.8e-005, 2.6e-027, [["CAAATTG", 12, 1, 1.8e-004, 3.8e+001], ["CAAGTTT", 16, 5, 1.1e-003, 2.4e+002], ["CAAGTTG", 9, 1, 2.0e-003, 4.3e+002], ["CAAATTT", 34, 23, 3.2e-003, 6.9e+002]]];
      motif_seqs[41] = ["m41", "ATGWRCA", "TGYWCAT", 7, 51, 51, 15, 1.7e-009, 3.7e-004, 8.8e-012, [["ATGAACA", 16, 4, 4.3e-004, 9.0e+001], ["ATGAGCA", 9, 1, 2.0e-003, 4.3e+002], ["ATGTGCA", 10, 2, 3.4e-003, 7.2e+002], ["ATGTACA", 16, 8, 9.6e-003, 2.0e+003]]];
      motif_seqs[42] = ["m42", "CCMMAAA", "TTTKKGG", 7, 54, 53, 19, 1.7e-008, 3.5e-003, 2.1e-024, [["CCAAAAA", 20, 2, 1.5e-006, 3.0e-001], ["CCCAAAA", 22, 8, 3.2e-004, 6.7e+001], ["CCCCAAA", 19, 8, 1.9e-003, 3.9e+002], ["CCACAAA", 10, 3, 9.4e-003, 2.0e+003]]];
      motif_seqs[43] = ["m43", "HAAGGCA", "TGCCTTD", 7, 44, 42, 12, 3.5e-008, 7.2e-003, 4.2e-004, [["TAAGGCA", 19, 5, 1.5e-004, 3.2e+001], ["AAAGGCA", 15, 5, 2.1e-003, 4.3e+002], ["CAAGGCA", 9, 2, 7.1e-003, 1.5e+003]]];
      motif_seqs[44] = ["m44", "CTYTRCC", "GGYARAG", 7, 59, 59, 20, 9.7e-010, 2.0e-004, 6.0e-009, [["CTCTGCC", 12, 2, 7.7e-004, 1.6e+002], ["CTTTGCC", 12, 2, 7.7e-004, 1.6e+002], ["CTTTACC", 17, 7, 2.9e-003, 6.0e+002], ["CTCTACC", 18, 9, 6.1e-003, 1.2e+003]]];
      motif_seqs[45] = ["m45", "CHTTCAG", "CTGAADG", 7, 25, 25, 2, 2.5e-008, 4.9e-003, 5.5e-013, [["CTTTCAG", 11, 2, 1.6e-003, 3.3e+002], ["CATTCAG", 7, 0, 1.9e-003, 3.9e+002], ["CCTTCAG", 7, 0, 1.9e-003, 3.9e+002]]];
      motif_seqs[46] = ["m46", "CAAGATD", "HATCTTG", 7, 36, 36, 9, 9.2e-008, 1.8e-002, 4.0e-013, [["CAAGATG", 8, 0, 7.8e-004, 1.6e+002], ["CAAGATA", 15, 4, 8.4e-004, 1.7e+002], ["CAAGATT", 13, 5, 7.2e-003, 1.4e+003]]];
      motif_seqs[47] = ["m47", "CAGTARA", "TYTACTG", 7, 36, 36, 9, 9.2e-008, 1.8e-002, 1.5e-012, [["CAGTAAA", 25, 7, 2.0e-005, 3.9e+000], ["CAGTAGA", 11, 2, 1.6e-003, 3.2e+002]]];
      motif_seqs[48] = ["m48", "ACAATKG", "CMATTGT", 7, 20, 20, 1, 2.2e-007, 4.2e-002, 2.3e-007, [["ACAATTG", 12, 1, 1.8e-004, 3.5e+001], ["ACAATGG", 8, 0, 7.8e-004, 1.5e+002]]];
      motif_seqs[49] = ["m49", "CTTSGTA", "TACSAAG", 7, 17, 17, 0, 2.5e-007, 4.8e-002, 1.3e-003, [["CTTGGTA", 9, 0, 3.2e-004, 6.3e+001], ["CTTCGTA", 8, 0, 7.8e-004, 1.5e+002]]];

    
    /* START INCLUDED FILE "delay_draw.js" */
      // 
      // return true if any part of the passed element is visible in the viewport
      //
      function element_in_viewport(elem) {
        var rect;
        try {
          rect = elem.getBoundingClientRect();
        } catch (e) {
          return false;
        }
        return (
            rect.top < (window.innerHeight || document.body.clientHeight) &&
            rect.bottom > 0 &&
            rect.left < (window.innerWidth || document.body.clientWidth) &&
            rect.right > 0
            );
      }

      //
      // Functions to delay a drawing task until it is required or it would not lag the display to do so
      //

      // a list of items still to be drawn
      var drawable_list = [];
      // the delay between drawing objects that are not currently visible
      var draw_delay = 1;
      // the delay after a user interaction
      var user_delay = 300;
      // the delay after a user has stopped scrolling and is viewing the stuff drawn on the current page
      var stop_delay = 300;
      // the timer handle; allows resetting of the timer after user interactions
      var draw_timer = null;

      //
      // Drawable
      //
      // elem - a page element which defines the position on the page that drawing is to be done
      // task - an object with the method run which takes care of painting the object
      //
      var Drawable = function(elem, task) {
        this.elem = elem;
        this.task = task;
      }

      //
      // Drawable.is_visible
      //
      // Determines if the element is visible in the viewport
      //
      Drawable.prototype.is_visible = function() {
        return element_in_viewport(this.elem);
      }

      //
      // Drawable.run
      //
      // Run the task held by the drawable
      Drawable.prototype.run = function() {
        if (this.task) this.task.run();
        this.task = null;
      }

      //
      // Drawable.run
      //
      // Run the task iff visible
      // returns true if the task ran or has already run
      Drawable.prototype.run_visible = function() {
        if (this.task) {
          if (element_in_viewport(this.elem)) {
            this.task.run();
            this.task = null;
            return true;
          }
          return false;
        } else {
          return true;
        }
      }

      //
      // draw_on_screen
      //
      // Checks each drawable object and draws those on screen.
      //
      function draw_on_screen() {
        var found = false;
        for (var i = 0; i < drawable_list.length; i++) {
          if (drawable_list[i].run_visible()) {
            drawable_list.splice(i--, 1);
            found = true;
          }
        }
        return found;
      }

      //
      // process_draw_tasks
      //
      // Called on a delay to process the next avaliable
      // draw task.
      //
      function process_draw_tasks() {
        var delay = draw_delay;
        draw_timer = null;
        if (drawable_list.length == 0) return; //no more tasks
        if (draw_on_screen()) {
          delay = stop_delay; //give the user a chance to scroll
        } else {
          //get next task
          var drawable = drawable_list.shift();
          drawable.task.run();
        }
        //allow UI updates between tasks
        draw_timer = window.setTimeout("process_draw_tasks()", delay);
      }

      //
      // delayed_process_draw_tasks
      //
      // Call process_draw_tasks after a short delay.
      // The delay serves to group multiple redundant events.       
      // Should be set as event handler for onscroll and onresize.
      //
      function delayed_process_draw_tasks() {
        //reset the timer
        if (drawable_list.length > 0) { 
          if (draw_timer != null) clearTimeout(draw_timer);
          draw_timer = window.setTimeout("process_draw_tasks()", user_delay);
        }
      }

      //
      // add_draw_task
      //
      // Add a drawing task to be called immediately if it is
      // visible, or to be called on a delay to reduce stuttering
      // effect on the web browser.
      function add_draw_task(elem, task) {
        drawable = new Drawable(elem, task);
        if (drawable.is_visible()) {
          task.run();
        } else {
          drawable_list.push(drawable);
          //reset timer
          if (draw_timer != null) clearTimeout(draw_timer);
          draw_timer = window.setTimeout("process_draw_tasks()", user_delay);
        }
      }

    /* END INCLUDED FILE "delay_draw.js" */
    
  
    
    /* START INCLUDED FILE "motif_logo.js" */
var _alph_red = "rgb(204,0,0)";
var _alph_blue = "rgb(0,0,204)";
var _alph_orange = "rgb(255,179,0)";
var _alph_green = "rgb(0,128,0)";
var _alph_yellow = "rgb(255,255,0)";
var _alph_purple = "rgb(204,0,204)";
var _alph_magenta = "rgb(255,0,255)";
var _alph_pink = "rgb(255,204,204)";
var _alph_turquoise = "rgb(51,230,204)";
var DNA_colours = [_alph_red, _alph_blue, _alph_orange, _alph_green];
var AA_colours = [_alph_blue, _alph_blue, _alph_magenta, _alph_magenta, 
    _alph_blue, _alph_orange, _alph_pink, _alph_blue, _alph_red, _alph_blue, 
    _alph_blue, _alph_green, _alph_yellow, _alph_green, _alph_red, _alph_green,
    _alph_green, _alph_blue, _alph_blue, _alph_turquoise];
//======================================================================
// start Alphabet object
//======================================================================
var Alphabet = function (alphabet, freqs, colours) {
  "use strict";
  function has_letters(letters, lookup) {
    "use strict";
    var i;
    for (i = 0; i < letters.length; i++) {
      if (!lookup[letters.charAt(i)]) return false;
    }
    return true;
  }
  function map_colours(letters, colours, lookup) {
    "use strict";
    var i, map;
    map = [];
    for (i = 0; i < letters.length; i++) {
      map.push(colours[lookup[letters.charAt(i)]-1]);
    }
    return map;
  }
  var is_alphabet, parts, ll, i, letter; 
  var is_letter, is_prob, freq, freq_lookup;
  var len, order, order_len, prob_sum, delta;
  var hue, sat, light, step;
  // variable prototype
  this.alphabet = [];
  this.freqs = [];
  this.colours = [];
  this.alphabet_to_index = {};
  this.ic = 1;
  this.is_dna_alph = false;
  this.is_rna_alph = false;
  this.is_aa_alph = false;
  //construct
  delta = 0.1;
  // parse the alphabet string
  if (typeof alphabet === "string") {
    // check for acceptable letters
    is_alphabet = /^[a-zA-Z]+$/;
    if (!is_alphabet.test(alphabet)) {
      throw new Error("Unacceptable letters in alphabet.");
    }
    // check for repeated letters
    parts = alphabet.split("");
    ll = {};
    for (i = 0; i < parts.length; i++) {
      letter = parts[i].toUpperCase();
      if (ll[letter]) {
        throw new Error("Repeated letter in alphabet.");
      }
      ll[letter] = i+1;
    }
    // alphabet is ok
    this.alphabet = parts;
    // calculate information content per letter
    this.ic = Math.log(this.alphabet.length) / Math.LN2;
    // try to determine if DNA, RNA, AA or other
    if (this.alphabet.length == 4) {
      this.is_dna_alph = has_letters("ACGT", ll);
      this.is_rna_alph = has_letters("ACGU", ll);
    } else if (this.alphabet.length == 20) {
      this.is_aa_alph = has_letters("ACDEFGHIKLMNPQRSTVWY",ll);
    }
    for (i = 0; i < this.alphabet.length; i++) {
      this.alphabet_to_index[this.alphabet[i].toUpperCase()] = i;
    }
  } else {
    throw new Error("Expected Alphabet to be a string");
  }
  // parse the frequencies, may be string or array
  if (typeof freqs === "string") {
    is_letter = /^[a-zA-Z]$/;
    is_prob = /^((1(\.0+)?)|(0(\.\d+)?))$/;
    parts = trim(freqs).split(/\s+/);
    freq_lookup = {};
    if (parts.length % 2 !== 0) {
      throw new Error("Expected pairs in Alphabet freqs string");
    }
    if (parts.length / 2 !== this.alphabet.length) {
      throw new Error("Expected a pair for each letter in Alphabet freqs string");
    }
    prob_sum = 0;
    for (i = 0; i < parts.length; i += 2) {
      letter = parts[i].toUpperCase();
      freq = parts[i+1];
      if (!is_letter.test(letter)) {
        throw new Error("Expected a letter at position " + i + 
            " in Alphabet freqs string");
      } 
      if (!is_prob.test(freq)) {
        throw new Error("Expected a probability at position " + (i + 1) +
            " in Alphabet freqs string");
      }
      freq = parseFloat(freq);
      freq_lookup[letter] = freq;
      prob_sum += freq;
    }
    for (i = 0; i < this.alphabet.length; i++) {
      letter = this.alphabet[i];
      freq = freq_lookup[letter];
      if (typeof freq === "undefined") {
        throw new Error("No frequency given for letter " + letter);
      }
      this.freqs.push(freq);
    }
    if (Math.abs(prob_sum - 1.0) > delta) {
      throw new Error("Sum of probabilities for order-" + order + 
          " background did not equal 1.");
    }
  } else if (typeof freqs === "object" && freqs instanceof Array) {
    // allow higher order backgrounds then we use (we use order-0)
    prob_sum = 0;
    order = 0;
    len = this.alphabet.length;
    order_len = this.alphabet.length;
    for (i = 0; i < freqs.length; i++) {
      if (i == len) {
        if (Math.abs(prob_sum - 1.0) > delta) {
          throw new Error("Sum of probabilities for order-" + order + " background did not equal 1.");
        }
        prob_sum = 0;
        order_len *= this.alphabet.length;
        order++;
        len += order_len;
      }
      prob_sum += freqs[i];
      if (order == 0) {
        this.freqs.push(freqs[i]);
      }
    }
    if (i !== len) {
      throw new Error("Length of background frequencies did not match " +
          "a complete order-" + order + " background");
    }
    if (Math.abs(prob_sum - 1.0) > delta) {
      throw new Error("Sum of probabilities for order-" + order + 
          " background did not equal 1.");
    }
  } else if (typeof freqs === "undefined") {
    freq = 1.0 / this.alphabet.length;
    for (i = 0; i < this.alphabet.length; i++) {
      this.freqs.push(freq);
    }
  } else {
    throw new Error("Expected freqs to be a string or an array");
  }
  if (typeof colours === "object" && colours instanceof Array) {
    if (colours.length != this.alphabet.length) {
      throw new Error("Length of colours array does not match letters in alphabet");
    }
    for (i = 0; i < colours.length; i++) {
      this.colours.push(colours[i]);
    }
  } else if (typeof colours === "undefined") {
    if (this.is_dna_alph) {
      this.colours = map_colours("ACGT", DNA_colours, ll);
    } else if (this.is_rna_alph) {
      this.colours = map_colours("ACGU", DNA_colours, ll);
    } else if (this.is_aa_alph) {
      this.colours = map_colours("ACDEFGHIKLMNPQRSTVWY", AA_colours, ll);
    } else {
      // use hsl colours
      hue = 0; //red
      sat = 100;
      light = 40;
      step = 360.0 / this.alphabet.length;
      for (i = 0; i < this.alphabet.length; i++) {
        this.colours.push("hsl(" + ((hue + step * i) % 360) + ", " + sat + "%, " + light + "%)");
      }
    }
  }
};

Alphabet.prototype.get_ic = function() {
  "use strict";
  return this.ic;
};

Alphabet.prototype.get_size = function() {
  "use strict";
  return this.alphabet.length;
};

Alphabet.prototype.get_letter = function(alph_index) {
  "use strict";
  if (alph_index < 0 || alph_index >= this.alphabet.length) {
    throw new Error("BAD_ALPHABET_INDEX");
  }
  return this.alphabet[alph_index];
};

Alphabet.prototype.get_letters = function() {
  "use strict";
  return this.alphabet.join("");
};

Alphabet.prototype.get_bg_freq = function(alph_index) {
  "use strict";
  if (alph_index < 0 || alph_index >= this.alphabet.length) {
    throw new Error("BAD_ALPHABET_INDEX");
  }
  return this.freqs[alph_index];
};

Alphabet.prototype.get_colour = function(alph_index) {
  "use strict";
  if (alph_index == -1) {
    return "black";
  }
  if (alph_index < 0 || alph_index >= this.alphabet.length) {
    throw new Error("BAD_ALPHABET_INDEX");
  }
  return this.colours[alph_index];
};

Alphabet.prototype.get_index = function(letter) {
  "use strict";
  var i;
  i = this.alphabet_to_index[letter.toUpperCase()];
  if (typeof i === "undefined") {
    return -1;
  }
  return i;
};

Alphabet.prototype.is_dna = function() {
  "use strict";
  return this.is_dna_alph;
};

Alphabet.prototype.toString = function() {
  "use strict";
  return  "Alphabet " + (this.alphabet.join(""));
};

//======================================================================
// end Alphabet object
//======================================================================

//======================================================================
// start Symbol object
//======================================================================
var Symbol = function(alph_index, scale, alphabet) {
  "use strict";
  //variable prototype
  this.symbol = alphabet.get_letter(alph_index);
  this.scale = scale;
  this.colour = alphabet.get_colour(alph_index);
};

Symbol.prototype.get_symbol = function() {
  "use strict";
  return this.symbol;
};

Symbol.prototype.get_scale = function() {
  "use strict";
  return this.scale;
};

Symbol.prototype.get_colour = function() {
  "use strict";
  return this.colour;
};

Symbol.prototype.toString = function() {
  "use strict";
  return this.symbol + " " + (Math.round(this.scale*1000)/10) + "%";
};

function compare_symbol(sym1, sym2) {
  "use strict";
  if (sym1.get_scale() < sym2.get_scale()) {
    return -1;
  } else if (sym1.get_scale() > sym2.get_scale()) {
    return 1;
  } else {
    return 0;
  }
}
//======================================================================
// end Symbol object
//======================================================================

//======================================================================
// start Pspm object
//======================================================================
var Pspm = function(matrix, name, ltrim, rtrim, nsites, evalue) {
  "use strict";
  var row, col, data, row_sum, delta, evalue_re;
  if (typeof name !== "string") {
    name = "";
  }
  this.name = name;
  //construct
  if (matrix instanceof Pspm) {
    // copy constructor
    this.alph_length = matrix.alph_length;
    this.motif_length = matrix.motif_length;
    this.name = matrix.name;
    this.nsites = matrix.nsites;
    this.evalue = matrix.evalue;
    this.ltrim = matrix.ltrim;
    this.rtrim = matrix.rtrim;
    this.pspm = [];
    for (row = 0; row < matrix.motif_length; row++) {
      this.pspm[row] = [];
      for (col = 0; col < matrix.alph_length; col++) {
        this.pspm[row][col] = matrix.pspm[row][col];
      }
    }
  } else {
    // check parameters
    if (typeof ltrim === "undefined") {
      ltrim = 0;
    } else if (typeof ltrim !== "number" || ltrim % 1 !== 0 || ltrim < 0) {
      throw new Error("ltrim must be a non-negative integer, got: " + ltrim);
    }
    if (typeof rtrim === "undefined") {
      rtrim = 0;
    } else if (typeof rtrim !== "number" || rtrim % 1 !== 0 || rtrim < 0) {
      throw new Error("rtrim must be a non-negative integer, got: " + rtrim);
    }
    if (typeof nsites !== "undefined") {
      if (typeof nsites !== "number" || nsites <= 0) {
        throw new Error("nsites must be a positive number, got: " + nsites);
      }
    }
    if (typeof evalue !== "undefined") {
      if (typeof evalue === "number") {
        if (evalue < 0) {
          throw new Error("evalue must be a non-negative number, got: " + evalue);
        }
      } else if (typeof evalue === "string") {
        evalue_re = /^((?:[+]?[0-9]*\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|inf)$/;
        if (!evalue_re.test(evalue)) {
          throw new Error("evalue must be a non-negative number, got: " + evalue);
        }
      } else {
        throw new Error("evalue must be a non-negative number, got: " + evalue);
      }
    }
    // set properties
    this.name = name;
    this.nsites = nsites;
    this.evalue = evalue;
    this.ltrim = ltrim;
    this.rtrim = rtrim;
    if (typeof matrix === "string") {
      // string constructor
      data = parse_pspm_string(matrix);
      this.alph_length = data["alph_length"];
      this.motif_length = data["motif_length"];
      this.pspm = data["pspm"];
      if (typeof this.evalue === "undefined") {
        if (typeof data["evalue"] !== "undefined") {
          this.evalue = data["evalue"];
        } else {
          this.evalue = 0;
        }
      }
      if (typeof this.nsites === "undefined") {
        if (typeof data["nsites"] === "number") {
          this.nsites = data["nsites"];
        } else {
          this.nsites = 20;
        }
      }
    } else {
      // assume pspm is a nested array
      this.motif_length = matrix.length;
      this.alph_length = (matrix.length > 0 ? matrix[0].length : 0);
      if (typeof this.nsites === "undefined") {
        this.nsites = 20;
      }
      if (typeof this.evalue === "undefined") {
        this.evalue = 0;
      }
      this.pspm = [];
      // copy pspm and check
      for (row = 0; row < this.motif_length; row++) {
        if (this.alph_length != matrix[row].length) {
          throw new Error("COLUMN_MISMATCH");
        }
        this.pspm[row] = [];
        row_sum = 0;
        for (col = 0; col < this.alph_length; col++) {
          this.pspm[row][col] = matrix[row][col];
          row_sum += this.pspm[row][col];
        }
        delta = 0.1;
        if (isNaN(row_sum) || (row_sum > 1 && (row_sum - 1) > delta) || 
            (row_sum < 1 && (1 - row_sum) > delta)) {
          throw new Error("INVALID_SUM");
        }
      }
    }
  }
};

Pspm.prototype.copy = function() {
  "use strict";
  return new Pspm(this);
};

Pspm.prototype.reverse_complement = function(alphabet) {
  "use strict";
  var x, y, temp, a_index, c_index, g_index, t_index, i, row, temp_trim;
  if (this.alph_length != alphabet.get_size()) {
    throw new Error("ALPHABET_MISMATCH");
  }
  if (!alphabet.is_dna()) {
    throw new Error("Only DNA motifs may be reverse complemented");
  }
  //reverse
  x = 0;
  y = this.motif_length-1;
  while (x < y) {
    temp = this.pspm[x];
    this.pspm[x] = this.pspm[y];
    this.pspm[y] = temp;
    x++;
    y--;
  }
  //complement
  a_index = alphabet.get_index("A");
  c_index = alphabet.get_index("C");
  g_index = alphabet.get_index("G");
  t_index = alphabet.get_index("T");
  for (i = 0; i < this.motif_length; i++) {
    row = this.pspm[i];
    //swap A and T
    temp = row[a_index];
    row[a_index] = row[t_index];
    row[t_index] = temp;
    //swap C and G
    temp = row[c_index];
    row[c_index] = row[g_index];
    row[g_index] = temp;
  }
  //swap triming
  temp_trim = this.ltrim;
  this.ltrim = this.rtrim;
  this.rtrim = temp_trim;
  //note that ambigs are ignored because they don't effect motifs
  return this; //allow function chaining...
};

Pspm.prototype.get_stack = function(position, alphabet) {
  "use strict";
  var row, stack_ic, alphabet_ic, stack, i, sym;
  if (this.alph_length != alphabet.get_size()) {
    throw new Error("ALPHABET_MISMATCH");
  }
  row = this.pspm[position];
  stack_ic = this.get_stack_ic(position, alphabet);
  alphabet_ic = alphabet.get_ic();
  stack = [];
  for (i = 0; i < this.alph_length; i++) {
    sym = new Symbol(i, row[i]*stack_ic/alphabet_ic, alphabet);
    if (sym.get_scale() <= 0) {
      continue;
    }
    stack.push(sym);
  }
  stack.sort(compare_symbol);
  return stack;
};

Pspm.prototype.get_stack_ic = function(position, alphabet) {
  "use strict";
  var row, H, i;
  if (this.alph_length != alphabet.get_size()) {
    throw new Error("ALPHABET_MISMATCH");
  }
  row = this.pspm[position];
  H = 0;
  for (i = 0; i < this.alph_length; i++) {
    if (row[i] === 0) {
      continue;
    }
    H -= (row[i] * (Math.log(row[i]) / Math.LN2));
  }
  return alphabet.get_ic() - H;
};

Pspm.prototype.get_error = function(alphabet) {
  "use strict";
  if (this.nsites === 0) {
    return 0;
  }
  return (alphabet.get_size()-1) / (2 * Math.log(2)*this.nsites);
};

Pspm.prototype.get_motif_length = function() {
  "use strict";
  return this.motif_length;
};

Pspm.prototype.get_alph_length = function() {
  "use strict";
  return this.alph_length;
};

Pspm.prototype.get_left_trim = function() {
  "use strict";
  return this.ltrim;
};

Pspm.prototype.get_right_trim = function() {
  "use strict";
  return this.rtrim;
};

Pspm.prototype.as_count_matrix = function() {
  "use strict";
  var count, count_text, text;
  var i, j;
  text = "";
  for (i = 0; i < this.motif_length; i++) {
    if (i !== 0) {
      text += "\n";
    }
    for (j = 0; j < this.alph_length; j++) {
      if (j !== 0) {
        text += " ";
      }
      count = Math.round(this.nsites * this.pspm[i][j]);
      count_text = "" + count;
      // pad up to length of 4
      if (count_text.length < 4) {
        text += (new Array(5 - count_text.length)).join(" ") + count_text;
      } else {
        text += count_text;
      }
    }
  }
  return text; 
};

Pspm.prototype.as_probability_matrix = function() {
  "use strict";
  var text;
  var i, j;
  text = "";
  for (i = 0; i < this.motif_length; i++) {
    if (i !== 0) {
      text += "\n";
    }
    for (j = 0; j < this.alph_length; j++) {
      if (j !== 0) {
        text += " ";
      }
      text += this.pspm[i][j].toFixed(6);
    }
  }
  return text; 
};

Pspm.prototype.as_pspm = function() {
  "use strict";
  return "letter-probability matrix: alength= " + this.alph_length + 
      " w= " + this.motif_length + " nsites= " + this.nsites + 
      " E= " + (typeof this.evalue === "number" ? 
          this.evalue.toExponential() : this.evalue) + "\n" +
      this.as_probability_matrix();
};

Pspm.prototype.as_pssm = function(alphabet, pseudo) {
  "use strict";
  var out, total, row, col, p, bg, p2, score, score_text;
  if (typeof pseudo === "undefined") {
    pseudo = 0.1;
  } else if (typeof pseudo !== "number") {
    throw new Error("Expected number for pseudocount");
  }
  out = "log-odds matrix: alength= " + this.alph_length + 
      " w= " + this.motif_length + 
      " E= " + (typeof this.evalue == "number" ? 
          this.evalue.toExponential() : this.evalue) + "\n";
  total = this.nsites + pseudo;
  for (row = 0; row < this.motif_length; row++) {
    for (col = 0; col < this.alph_length; col++) {
      if (col !== 0) {
        out += " ";
      }
      p = this.pspm[row][col];
      // to avoid log of zero we add a pseudo count
      bg = alphabet.get_bg_freq(col);
      p2 = (p * this.nsites + bg * pseudo) / total;
      // now calculate the score
      score = -10000;
      if (p2 > 0) {
        score = Math.round((Math.log(p2 / bg) / Math.LN2) * 100);
      }
      score_text = "" + score;
      // pad out to 6 characters
      if (score_text.length < 6) {
        out += (new Array(7 - score_text.length)).join(" ") + score_text;
      } else {
        out += score_text;
      }
    }
    out += "\n";
  }
  return out;
};

Pspm.prototype.as_meme = function(options) {
  var with_header, with_pspm, with_pssm, version, alphabet, bg_source, pseudocount, strands;
  var out, alen, i;
  // get the options
  if (typeof options !== "object" || options === null) {
    options = {};
  }
  with_header = (typeof options["with_header"] === "boolean" ? options["with_header"] : false);
  with_pspm = (typeof options["with_pspm"] === "boolean" ? options["with_pspm"] : false);
  with_pssm = (typeof options["with_pssm"] === "boolean" ? options["with_pssm"] : false);
  if (!with_pspm && !with_pssm) with_pspm = true;
  if (with_header) {
    if (typeof options["version"] === "string" && /^\d+(?:\.\d+){0,2}$/.test(options["version"])) {
      version = options["version"];
    } else if (typeof options["version"] === "number") {
      version = options["version"].toFixed(0);
    } else {
      version = "4";
    }
    if (typeof options["strands"] === "number" && options["strands"] === 1) {
      strands = 1;
    } else {
      strands = 2;
    }
    if (typeof options["bg_source"] === "string") {
      bg_source = options["bg_source"];
    } else {
      bg_source = "unknown source";
    }
  }
  if (with_header || with_pssm) {
    if (typeof options["alphabet"] === "object" && options["alphabet"] != null
        && options["alphabet"] instanceof Alphabet) {
      alphabet = options["alphabet"];
    } else {
      alphabet = (this.get_alph_length() == 4 ? 
          new Alphabet("ACGT") : new Alphabet("ACDEFGHIKLMNPQRSTVWY"));
      bg_source = "uniform distribution";
    }
  }
  if (with_pssm) {
    if (typeof options["pseudocount"] === "number") {
      pseudocount = options["pseudocount"];
    } else {
      pseudocount = 0.01; // used by MEME to generate PSSMs from PSPMs
    }
  }
  // now create the output
  out = "";
  if (with_header) {
    out = "MEME version " + version + "\n\n";
    out += "ALPHABET= " + alphabet.get_letters().toUpperCase() + "\n\n";
    if (alphabet.is_dna()) { // assume DNA has both strands unless otherwise specified
      out += "strands: " + (strands === 1 ? "+" : "+ -") + "\n\n";
    }
    out += "Background letter frequencies (from " + bg_source + "):\n";
    alen = alphabet.get_size();
    for (i = 0; i < alen; i++) {
      if (i !== 0) {
        if (i % 9 === 0) { // maximum of nine entries per line
          out += "\n";
        } else {
          out += " ";
        }
      }
      out += alphabet.get_letter(i) + " " + alphabet.get_bg_freq(i).toFixed(3);
    }
  }
  out += "\n\n";
  out += "MOTIF " + this.name;
  if (with_pspm) {
    out += "\n\n";
    out += this.as_pspm();
  }
  if (with_pssm) {
    out += "\n\n";
    out += this.as_pssm(alphabet, pseudocount);
  }
  return out;
}

Pspm.prototype.as_minimal_meme = function(version, alphabet, options) {
  "use strict";
  function format_matrix(matrix, pad) {
    "use strict";
    var row, col, col_text, out;
    out = "";
    for (row = 0; row < matrix.length; row++) {
      if (row !== 0) {
        out += "\n";
      }
      for (col = 0; col < matrix[row].length; col++) {
        if (col !== 0) {
          out += " ";
        }
        col_text = "" + matrix[row][col];
        if (col_text.length < pad) {
          out += (new Array(pad + 1 - col_text.length)).join(" ") + col_text;
        } else {
          out += col_text;
        }
      }
    }
    return out;
  }
  var out, alen, i;
  out = "MEME version " + version + "\n\n";
  out += "ALPHABET= " + alphabet.get_letters().toUpperCase() + "\n\n";
  if (alphabet.is_dna()) { // assume DNA has both strands unless otherwise specified
    out += "strands: " + (options["strands"] === 1 ? "+" : "+ -") + "\n\n";
  }
  out += "Background letter frequencies (from " + (options["bg_source"] || "unknown source") + "):\n";
  alen = alphabet.get_size();
  for (i = 0; i < alen; i++) {
    if (i !== 0) {
      if (i % 9 === 0) { // maximum of nine entries per line
        out += "\n";
      } else {
        out += " ";
      }
    }
    out += alphabet.get_letter(i) + " " + alphabet.get_bg_freq(i).toFixed(3);
  }
  out += "\n\n";
  out += "MOTIF " + this.name + "\n\n";
  out += this.as_pspm();
  if (typeof options["scores"] === "object") {
    out += "\n\nlog-odds matrix: alength= " + alen + " w= " + this.pspm.length + " E= " + this.evalue + "\n";
    out += format_matrix(options["scores"], 6);
  }
  return out;
}

Pspm.prototype.toString = function() {
  "use strict";
  var str, i, row;
  str = "";
  for (i = 0; i < this.pspm.length; i++) {
    row = this.pspm[i];
    str += row.join("\t") + "\n";
  }
  return str;
};

function parse_pspm_properties(str) {
  "use strict";
  var parts, i, eqpos, before, after, properties, prop, num, num_re;
  num_re = /^((?:[+]?[0-9]*\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|inf)$/;
  parts = trim(str).split(/\s+/);
  // split up words containing =
  for (i = 0; i < parts.length;) {
    eqpos = parts[i].indexOf("=");
    if (eqpos != -1) {
      before = parts[i].substr(0, eqpos);
      after = parts[i].substr(eqpos+1);
      if (before.length > 0 && after.length > 0) {
        parts.splice(i, 1, before, "=", after);
        i += 3;
      } else if (before.length > 0) {
        parts.splice(i, 1, before, "=");
        i += 2;
      } else if (after.length > 0) {
        parts.splice(i, 1, "=", after);
        i += 2;
      } else {
        parts.splice(i, 1, "=");
        i++;
      }
    } else {
      i++;
    }
  }
  properties = {};
  for (i = 0; i < parts.length; i += 3) {
    if (parts.length - i < 3) {
      throw new Error("Expected PSPM property was incomplete. "+
          "Remaing parts are: " + parts.slice(i).join(" "));
    }
    if (parts[i+1] !== "=") {
      throw new Error("Expected '=' in PSPM property between key and " +
          "value but got " + parts[i+1]); 
    }
    prop = parts[i].toLowerCase();
    num = parts[i+2];
    if (!num_re.test(num)) {
      throw new Error("Expected numeric value for PSPM property '" + 
          prop + "' but got '" + num + "'");
    }
    properties[prop] = num;
  }
  return properties;
}

function parse_pspm_string(pspm_string) {
  "use strict";
  var header_re, lines, first_line, line_num, col_num, alph_length, 
      motif_length, nsites, evalue, pspm, i, line, match, props, parts,
      j, prob;
  header_re = /^letter-probability\s+matrix:(.*)$/i;
  lines = pspm_string.split(/\n/);
  first_line = true;
  line_num = 0;
  col_num = 0;
  alph_length;
  motif_length;
  nsites;
  evalue;
  pspm = [];
  for (i = 0; i < lines.length; i++) {
    line = trim(lines[i]);
    if (line.length === 0) { 
      continue;
    }
    // check the first line for a header though allow matrices without it
    if (first_line) {
      first_line = false;
      match = header_re.exec(line);
      if (match !== null) {
        props = parse_pspm_properties(match[1]);
        if (props.hasOwnProperty("alength")) {
          alph_length = parseFloat(props["alength"]);
          if (alph_length != 4 && alph_length != 20) {
            throw new Error("PSPM property alength should be 4 or 20" +
                " but got " + alph_length);
          }
        }
        if (props.hasOwnProperty("w")) {
          motif_length = parseFloat(props["w"]);
          if (motif_length % 1 !== 0 || motif_length < 1) {
            throw new Error("PSPM property w should be an integer larger " +
                "than zero but got " + motif_length);
          }
        }
        if (props.hasOwnProperty("nsites")) {
          nsites = parseFloat(props["nsites"]);
          if (nsites <= 0) {
            throw new Error("PSPM property nsites should be larger than " +
                "zero but got " + nsites);
          }
        }
        if (props.hasOwnProperty("e")) {
          evalue = props["e"];
          if (evalue < 0) {
            throw new Error("PSPM property evalue should be " +
                "non-negative but got " + evalue);
          }
        }
        continue;
      }
    }
    pspm[line_num] = [];
    col_num = 0;
    parts = line.split(/\s+/);
    for (j = 0; j < parts.length; j++) {
      prob = parseFloat(parts[j]);
      if (prob != parts[j] || prob < 0 || prob > 1) {
        throw new Error("Expected probability but got '" + parts[j] + "'"); 
      }
      pspm[line_num][col_num] = prob;
      col_num++;
    }
    line_num++;
  }
  if (typeof motif_length === "number") {
    if (pspm.length != motif_length) {
      throw new Error("Expected PSPM to have a motif length of " + 
          motif_length + " but it was actually " + pspm.length);
    }
  } else {
    motif_length = pspm.length;
  }
  if (typeof alph_length !== "number") {
    alph_length = pspm[0].length;
    if (alph_length != 4 && alph_length != 20) {
      throw new Error("Expected length of first row in the PSPM to be " +
          "either 4 or 20 but got " + alph_length);
    }
  }
  for (i = 0; i < pspm.length; i++) {
    if (pspm[i].length != alph_length) {
      throw new Error("Expected PSPM row " + i + " to have a length of " + 
          alph_length + " but the length was " + pspm[i].length);
    }
  }
  return {"pspm": pspm, "motif_length": motif_length, 
    "alph_length": alph_length, "nsites": nsites, "evalue": evalue};
}
//======================================================================
// end Pspm object
//======================================================================

//======================================================================
// start Logo object
//======================================================================

var Logo = function(alphabet, fine_text) {
  "use strict";
  this.alphabet = alphabet;
  this.fine_text = fine_text;
  this.pspm_list = [];
  this.pspm_column = [];
  this.rows = 0;
  this.columns = 0;
};

Logo.prototype.add_pspm = function(pspm, column) {
  "use strict";
  var col;
  if (typeof column === "undefined") {
    column = 0;
  } else if (column < 0) {
    throw new Error("Column index out of bounds.");
  }
  this.pspm_list[this.rows] = pspm;
  this.pspm_column[this.rows] = column;
  this.rows++;
  col = column + pspm.get_motif_length();
  if (col > this.columns) {
    this.columns = col;
  }
};

Logo.prototype.get_columns = function() {
  "use strict";
  return this.columns;
};

Logo.prototype.get_rows = function() {
  "use strict";
  return this.rows;
};

Logo.prototype.get_pspm = function(row_index) {
  "use strict";
  if (row_index < 0 || row_index >= this.rows) {
    throw new Error("INDEX_OUT_OF_BOUNDS");
  }
  return this.pspm_list[row_index];
};

Logo.prototype.get_offset = function(row_index) {
  "use strict";
  if (row_index < 0 || row_index >= this.rows) {
    throw new Error("INDEX_OUT_OF_BOUNDS");
  }
  return this.pspm_column[row_index];
};

//======================================================================
// end Logo object
//======================================================================

//======================================================================
// start RasterizedAlphabet
//======================================================================

// Rasterize Alphabet
// 1) Measure width of text at default font for all symbols in alphabet
// 2) sort in width ascending
// 3) Drop the top and bottom 10% (designed to ignore outliers like 'W' and 'I')
// 4) Calculate the average as the maximum scaling factor (designed to stop I becoming a rectangular blob).
// 5) Assume scale of zero would result in width of zero, interpolate scale required to make perfect width font
// 6) Draw text onto temp canvas at calculated scale
// 7) Find bounds of drawn text
// 8) Paint on to another canvas at the desired height (but only scaling width to fit if larger).
var RasterizedAlphabet = function(alphabet, font, target_width) {
  "use strict";
  var default_size, safety_pad, canvas, ctx, middle, baseline, widths, count,
      letters, i, letter, size, tenpercent, avg_width, scale, 
      target_height, raster;
  //variable prototypes
  this.lookup = []; //a map of letter to index
  this.rasters = []; //a list of rasters
  this.dimensions = []; //a list of dimensions

  //construct
  default_size = 60; // size of square to assume as the default width
  safety_pad = 20; // pixels to pad around so we don't miss the edges
  // create a canvas to do our rasterizing on
  canvas = document.createElement("canvas");
  // assume the default font would fit in a canvas of 100 by 100
  canvas.width = default_size + 2 * safety_pad;
  canvas.height = default_size + 2 * safety_pad;
  // check for canvas support before attempting anything
  if (!canvas.getContext) {
    throw new Error("NO_CANVAS_SUPPORT");
  }
  ctx = canvas.getContext('2d');
  // check for html5 text drawing support
  if (!supports_text(ctx)) {
    throw new Error("NO_CANVAS_TEXT_SUPPORT");
  }
  // calculate the middle
  middle = Math.round(canvas.width / 2);
  // calculate the baseline
  baseline = Math.round(canvas.height - safety_pad);
  // list of widths
  widths = [];
  count = 0;
  letters = [];
  //now measure each letter in the alphabet
  for (i = 0; i < alphabet.get_size(); ++i) {
    letter = alphabet.get_letter(i);
    letters.push(letter);
    this.lookup[letter] = count;
    //clear the canvas
    canvas.width = canvas.width;
    // get the context and prepare to draw our width test
    ctx = canvas.getContext('2d');
    ctx.font = font;
    ctx.fillStyle = alphabet.get_colour(i);
    ctx.textAlign = "center";
    ctx.translate(middle, baseline);
    // draw the test text
    ctx.fillText(letter, 0, 0);
    //measure
    size = canvas_bounds(ctx, canvas.width, canvas.height);
    if (size.width === 0) {
      throw new Error("INVISIBLE_LETTER"); //maybe the fill was white on white?
    }
    widths.push(size.width);
    this.dimensions[count] = size;
    count++;
  }
  //sort the widths
  widths.sort(function(a,b) {return a - b;});
  //drop 10% of the items off each end
  tenpercent = Math.floor(widths.length / 10);
  for (i = 0; i < tenpercent; ++i) {
    widths.pop();
    widths.shift();
  }
  //calculate average width
  avg_width = 0;
  for (i = 0; i < widths.length; ++i) {
    avg_width += widths[i];
  }
  avg_width /= widths.length;
  // calculate scales
  for (i = 0; i < this.dimensions.length; ++i) {
    size = this.dimensions[i];
    // calculate scale
    scale = target_width / Math.max(avg_width, size.width);
    // estimate scaled height
    target_height = size.height * scale;
    // create an approprately sized canvas
    raster = document.createElement("canvas");
    raster.width = target_width; // if it goes over the edge too bad...
    raster.height = target_height + safety_pad * 2;
    // calculate the middle
    middle = Math.round(raster.width / 2);
    // calculate the baseline
    baseline = Math.round(raster.height - safety_pad);
    // get the context and prepare to draw the rasterized text
    ctx = raster.getContext('2d');
    ctx.font = font;
    ctx.fillStyle = alphabet.get_colour(i);
    ctx.textAlign = "center";
    ctx.translate(middle, baseline);
    ctx.save();
    ctx.scale(scale, scale);
    // draw the rasterized text
    ctx.fillText(letters[i], 0, 0);
    ctx.restore();
    this.rasters[i] = raster;
    this.dimensions[i] = canvas_bounds(ctx, raster.width, raster.height);
  }
};

function canvas_bounds(ctx, cwidth, cheight) {
  "use strict";
  var data, r, c, top_line, bottom_line, left_line, right_line, 
      txt_width, txt_height;
  data = ctx.getImageData(0, 0, cwidth, cheight).data;
  r = 0; c = 0; // r: row, c: column
  top_line = -1; bottom_line = -1; left_line = -1; right_line = -1;
  txt_width = 0; txt_height = 0;
  // Find the top-most line with a non-white pixel
  for (r = 0; r < cheight; r++) {
    for (c = 0; c < cwidth; c++) {
      if (data[r * cwidth * 4 + c * 4 + 3]) {
        top_line = r;
        break;
      }
    }
    if (top_line != -1) {
      break;
    }
  }
  
  //find the last line with a non-white pixel
  if (top_line != -1) {
    for (r = cheight-1; r >= top_line; r--) {
      for(c = 0; c < cwidth; c++) {
        if(data[r * cwidth * 4 + c * 4 + 3]) {
          bottom_line = r;
          break;
        }
      }
      if (bottom_line != -1) {
        break;
      }
    }
    txt_height = bottom_line - top_line + 1;
  }

  // Find the left-most line with a non-white pixel
  for (c = 0; c < cwidth; c++) {
    for (r = 0; r < cheight; r++) {
      if (data[r * cwidth * 4 + c * 4 + 3]) {
        left_line = c;
        break;
      }
    }
    if (left_line != -1) {
      break;
    }
  }

  //find the right most line with a non-white pixel
  if (left_line != -1) {
    for (c = cwidth-1; c >= left_line; c--) {
      for(r = 0; r < cheight; r++) {
        if(data[r * cwidth * 4 + c * 4 + 3]) {
          right_line = c;
          break;
        }
      }
      if (right_line != -1) {
        break;
      }
    }
    txt_width = right_line - left_line + 1;
  }

  //return the bounds
  return {bound_top: top_line, bound_bottom: bottom_line, 
    bound_left: left_line, bound_right: right_line, width: txt_width, 
    height: txt_height};
}

RasterizedAlphabet.prototype.draw = function(ctx, letter, dx, dy, dWidth, dHeight) {
  "use strict";
  var index, raster, size;
  index = this.lookup[letter];
  raster = this.rasters[index];
  size = this.dimensions[index];
  ctx.drawImage(raster, 0, size.bound_top -1, raster.width, size.height+1, dx, dy, dWidth, dHeight);
};

//======================================================================
// end RasterizedAlphabet
//======================================================================

//======================================================================
// start LogoMetrics object
//======================================================================

var LogoMetrics = function(ctx, logo_columns, logo_rows, allow_space_for_names) {
  "use strict";
  var i, row_height;
  if (typeof allow_space_for_names === "undefined") {
    allow_space_for_names = false;
  }
  //variable prototypes
  this.pad_top = 5;
  this.pad_left = 10;
  this.pad_right = 5;
  this.pad_bottom = 0;
  this.pad_middle = 20;
  this.name_height = 14;
  this.name_font = "bold " + this.name_height + "px Times, sans-serif";
  this.name_spacer = 0;
  this.y_label = "bits";
  this.y_label_height = 12;
  this.y_label_font = "bold " + this.y_label_height + "px Helvetica, sans-serif";
  this.y_label_spacer = 3;
  this.y_num_height = 12;
  this.y_num_width = 0;
  this.y_num_font = "bold " + this.y_num_height + "px Helvetica, sans-serif";
  this.y_tic_width = 5;
  this.stack_pad_left = 0;
  this.stack_font = "bold 25px Helvetica, sans-serif";
  this.stack_height = 90;
  this.stack_width = 26;
  this.stacks_pad_right = 5;
  this.x_num_above = 2;
  this.x_num_height = 12;
  this.x_num_width = 0;
  this.x_num_font = "bold " + this.x_num_height + "px Helvetica, sans-serif";
  this.fine_txt_height = 6;
  this.fine_txt_above = 2;
  this.fine_txt_font = "normal " + this.fine_txt_height + "px Helvetica, sans-serif";
  this.letter_metrics = new Array();
  this.summed_width = 0;
  this.summed_height = 0;
  //calculate the width of the y axis numbers
  ctx.font = this.y_num_font;
  for (i = 0; i <= 2; i++) {
    this.y_num_width = Math.max(this.y_num_width, ctx.measureText("" + i).width);
  }
  //calculate the width of the x axis numbers (but they are rotated so it becomes height)
  ctx.font = this.x_num_font;
  for (i = 1; i <= logo_columns; i++) {
    this.x_num_width = Math.max(this.x_num_width, ctx.measureText("" + i).width);
  }
  
  //calculate how much vertical space we want to draw this
  //first we add the padding at the top and bottom since that's always there
  this.summed_height += this.pad_top + this.pad_bottom;
  //all except the last row have the same amount of space allocated to them
  if (logo_rows > 1) {
    row_height = this.stack_height + this.pad_middle;
    if (allow_space_for_names) {
      row_height += this.name_height;
      //the label is allowed to overlap into the spacer
      row_height += Math.max(this.y_num_height/2, this.name_spacer); 
      //the label is allowed to overlap the space used by the other label
      row_height += Math.max(this.y_num_height/2, this.x_num_height + this.x_num_above); 
    } else {
      row_height += this.y_num_height/2; 
      //the label is allowed to overlap the space used by the other label
      row_height += Math.max(this.y_num_height/2, this.x_num_height + this.x_num_above); 
    }
    this.summed_height += row_height * (logo_rows - 1);
  }
  //the last row has the name and fine text below it but no padding
  this.summed_height += this.stack_height + this.y_num_height/2;
  if (allow_space_for_names) {
    this.summed_height += this.fine_txt_height + this.fine_txt_above + this.name_height;
    this.summed_height += Math.max(this.y_num_height/2, 
        this.x_num_height + this.x_num_above + this.name_spacer);
  } else {
    this.summed_height += Math.max(this.y_num_height/2, 
        this.x_num_height + this.x_num_above + this.fine_txt_height + this.fine_txt_above);
  }

  //calculate how much horizontal space we want to draw this
  //first add the padding at the left and right since that's always there
  this.summed_width += this.pad_left + this.pad_right;
  //add on the space for the y-axis label
  this.summed_width += this.y_label_height + this.y_label_spacer;
  //add on the space for the y-axis
  this.summed_width += this.y_num_width + this.y_tic_width;
  //add on the space for the stacks
  this.summed_width += (this.stack_pad_left + this.stack_width) * logo_columns;
  //add on the padding after the stacks (an offset from the fine text)
  this.summed_width += this.stacks_pad_right;

};

//======================================================================
// end LogoMetrics object
//======================================================================

//found this trick at http://talideon.com/weblog/2005/02/detecting-broken-images-js.cfm
function image_ok(img) {
  "use strict";
  // During the onload event, IE correctly identifies any images that
  // weren't downloaded as not complete. Others should too. Gecko-based
  // browsers act like NS4 in that they report this incorrectly.
  if (!img.complete) {
    return false;
  }
  // However, they do have two very useful properties: naturalWidth and
  // naturalHeight. These give the true size of the image. If it failed
  // to load, either of these should be zero.
  if (typeof img.naturalWidth !== "undefined" && img.naturalWidth === 0) {
    return false;
  }
  // No other way of checking: assume it's ok.
  return true;
}
  
function supports_text(ctx) {
  "use strict";
  if (!ctx.fillText) {
    return false;
  }
  if (!ctx.measureText) {
    return false;
  }
  return true;
}

//draws the scale, returns the width
function draw_scale(ctx, metrics, alphabet_ic) {
  "use strict";
  var tic_height, i;
  tic_height = metrics.stack_height / alphabet_ic;
  ctx.save();
  ctx.lineWidth = 1.5;
  ctx.translate(metrics.y_label_height, metrics.y_num_height/2);
  //draw the axis label
  ctx.save();
  ctx.font = metrics.y_label_font;
  ctx.translate(0, metrics.stack_height/2);
  ctx.save();
  ctx.rotate(-(Math.PI / 2));
  ctx.textAlign = "center";
  ctx.fillText("bits", 0, 0);
  ctx.restore();
  ctx.restore();

  ctx.translate(metrics.y_label_spacer + metrics.y_num_width, 0);

  //draw the axis tics
  ctx.save();
  ctx.translate(0, metrics.stack_height);
  ctx.font = metrics.y_num_font;
  ctx.textAlign = "right";
  ctx.textBaseline = "middle";
  for (i = 0; i <= alphabet_ic; i++) {
    //draw the number
    ctx.fillText("" + i, 0, 0);
    //draw the tic
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.lineTo(metrics.y_tic_width, 0);
    ctx.stroke();
    //prepare for next tic
    ctx.translate(0, -tic_height);
  }
  ctx.restore();

  ctx.translate(metrics.y_tic_width, 0);

  ctx.beginPath();
  ctx.moveTo(0, 0);
  ctx.lineTo(0, metrics.stack_height);
  ctx.stroke();

  ctx.restore();
}

function draw_stack_num(ctx, metrics, row_index) {
  "use strict";
  ctx.save();
  ctx.font = metrics.x_num_font;
  ctx.translate(metrics.stack_width / 2, metrics.stack_height + metrics.x_num_above);
  ctx.save();
  ctx.rotate(-(Math.PI / 2));
  ctx.textBaseline = "middle";
  ctx.textAlign = "right";
  ctx.fillText("" + (row_index + 1), 0, 0);
  ctx.restore();
  ctx.restore();
}

function draw_stack(ctx, metrics, symbols, raster) {
  "use strict";
  var preferred_pad, sym_min, i, sym, sym_height, pad;
  preferred_pad = 0;
  sym_min = 5;

  ctx.save();//1
  ctx.translate(0, metrics.stack_height);
  for (i = 0; i < symbols.length; i++) {
    sym = symbols[i];
    sym_height = metrics.stack_height * sym.get_scale();
    
    pad = preferred_pad;
    if (sym_height - pad < sym_min) {
      pad = Math.min(pad, Math.max(0, sym_height - sym_min));
    }
    sym_height -= pad;

    //translate to the correct position
    ctx.translate(0, -(pad/2 + sym_height));
    //draw
    raster.draw(ctx, sym.get_symbol(), 0, 0, metrics.stack_width, sym_height);
    //translate past the padding
    ctx.translate(0, -(pad/2));
  }
  ctx.restore();//1
}

function draw_dashed_line(ctx, pattern, start, x1, y1, x2, y2) {
  "use strict";
  var x, y, len, i, dx, dy, tlen, theta, mulx, muly, lx, ly;
  dx = x2 - x1;
  dy = y2 - y1;
  tlen = Math.pow(dx*dx + dy*dy, 0.5);
  theta = Math.atan2(dy,dx);
  mulx = Math.cos(theta);
  muly = Math.sin(theta);
  lx = [];
  ly = [];
  for (i = 0; i < pattern; ++i) {
    lx.push(pattern[i] * mulx);
    ly.push(pattern[i] * muly);
  }
  i = start;
  x = x1;
  y = y1;
  len = 0;
  ctx.beginPath();
  while (len + pattern[i] < tlen) {
    ctx.moveTo(x, y);
    x += lx[i];
    y += ly[i];
    ctx.lineTo(x, y);
    len += pattern[i];
    i = (i + 1) % pattern.length;
    x += lx[i];
    y += ly[i];
    len += pattern[i];
    i = (i + 1) % pattern.length;
  }
  if (len < tlen) {
    ctx.moveTo(x, y);
    x += mulx * (tlen - len);
    y += muly * (tlen - len);
    ctx.lineTo(x, y);
  }
  ctx.stroke();
}

function draw_trim_background(ctx, metrics, pspm, offset) {
  "use strict";
  var lwidth, rwidth, mwidth, rstart;
  lwidth = metrics.stack_width * pspm.get_left_trim();
  rwidth = metrics.stack_width * pspm.get_right_trim();
  mwidth = metrics.stack_width * pspm.get_motif_length();
  rstart = mwidth - rwidth;
  ctx.save();//s8
  ctx.translate(offset * metrics.stack_width, 0);
  ctx.fillStyle = "rgb(240, 240, 240)";
  if (pspm.get_left_trim() > 0) {
    ctx.fillRect(0, 0, lwidth, metrics.stack_height);
  }
  if (pspm.get_right_trim() > 0) {
    ctx.fillRect(rstart, 0, rwidth, metrics.stack_height);
  }
  ctx.fillStyle = "rgb(51, 51, 51)";
  if (pspm.get_left_trim() > 0) {
    draw_dashed_line(ctx, [3], 0, lwidth-0.5, 0, lwidth-0.5,  metrics.stack_height);
  }
  if (pspm.get_right_trim() > 0) {
    draw_dashed_line(ctx, [3], 0, rstart+0.5, 0, rstart+0.5,  metrics.stack_height);
  }
  ctx.restore();//s8
}

function size_logo_on_canvas(logo, canvas, show_names, scale) {
  "use strict";
  var draw_name, metrics;
  draw_name = (typeof show_names === "boolean" ? show_names : (logo.get_rows() > 1));
  if (canvas.width !== 0 && canvas.height !== 0) {
    return;
  }
  metrics = new LogoMetrics(canvas.getContext('2d'), 
      logo.get_columns(), logo.get_rows(), draw_name);
  if (typeof scale == "number") {
    //resize the canvas to fit the scaled logo
    canvas.width = metrics.summed_width * scale;
    canvas.height = metrics.summed_height * scale;
  } else {
    if (canvas.width === 0 && canvas.height === 0) {
      canvas.width = metrics.summed_width;
      canvas.height = metrics.summed_height;
    } else if (canvas.width === 0) {
      canvas.width = metrics.summed_width * (canvas.height / metrics.summed_height);
    } else if (canvas.height === 0) {
      canvas.height = metrics.summed_height * (canvas.width / metrics.summed_width);
    }
  }
}

function draw_logo_on_canvas(logo, canvas, show_names, scale) {
  "use strict";
  var draw_name, ctx, metrics, raster, pspm_i, pspm, 
      offset, col_index, motif_position;
  draw_name = (typeof show_names === "boolean" ? show_names : (logo.get_rows() > 1));
  ctx = canvas.getContext('2d');
  //assume that the user wants the canvas scaled equally so calculate what the best width for this image should be
  metrics = new LogoMetrics(ctx, logo.get_columns(), logo.get_rows(), draw_name);
  if (typeof scale == "number") {
    //resize the canvas to fit the scaled logo
    canvas.width = metrics.summed_width * scale;
    canvas.height = metrics.summed_height * scale;
  } else {
    if (canvas.width === 0 && canvas.height === 0) {
      scale = 1;
      canvas.width = metrics.summed_width;
      canvas.height = metrics.summed_height;
    } else if (canvas.width === 0) {
      scale = canvas.height / metrics.summed_height;
      canvas.width = metrics.summed_width * scale;
    } else if (canvas.height === 0) {
      scale = canvas.width / metrics.summed_width;
      canvas.height = metrics.summed_height * scale;
    } else {
      scale = Math.min(canvas.width / metrics.summed_width, canvas.height / metrics.summed_height);
    }
  }
  // cache the raster based on the assumption that we will be drawing a lot
  // of logos the same size and alphabet
  if (typeof draw_logo_on_canvas.raster_scale === "number" && 
      Math.abs(draw_logo_on_canvas.raster_scale - scale) < 0.1 &&
      logo.alphabet == draw_logo_on_canvas.raster_alphabet) {
    raster = draw_logo_on_canvas.raster_cache;
  } else {
    raster = new RasterizedAlphabet(logo.alphabet, metrics.stack_font, metrics.stack_width * scale * 2);
    draw_logo_on_canvas.raster_cache = raster;
    draw_logo_on_canvas.raster_scale = scale;
    draw_logo_on_canvas.raster_alphabet = logo.alphabet;
  }
  ctx = canvas.getContext('2d');
  ctx.save();//s1
  ctx.scale(scale, scale);
  ctx.save();//s2
  ctx.save();//s7
  //create margin
  ctx.translate(metrics.pad_left, metrics.pad_top);
  for (pspm_i = 0; pspm_i < logo.get_rows(); ++pspm_i) {
    pspm = logo.get_pspm(pspm_i);
    offset = logo.get_offset(pspm_i);
    //optionally draw name if this isn't the last row or is the only row 
    if (draw_name && (logo.get_rows() == 1 || pspm_i != (logo.get_rows()-1))) {
      ctx.save();//s4
      ctx.translate(metrics.summed_width/2, metrics.name_height);
      ctx.font = metrics.name_font;
      ctx.textAlign = "center";
      ctx.fillText(pspm.name, 0, 0);
      ctx.restore();//s4
      ctx.translate(0, metrics.name_height + 
          Math.min(0, metrics.name_spacer - metrics.y_num_height/2));
    }
    //draw scale
    draw_scale(ctx, metrics, logo.alphabet.get_ic());
    ctx.save();//s5
    //translate across past the scale
    ctx.translate(metrics.y_label_height + metrics.y_label_spacer + 
        metrics.y_num_width + metrics.y_tic_width, 0);
    //draw the trimming background
    if (pspm.get_left_trim() > 0 || pspm.get_right_trim() > 0) {
      draw_trim_background(ctx, metrics, pspm, offset);
    }
    //draw letters
    ctx.translate(0, metrics.y_num_height / 2);
    for (col_index = 0; col_index < logo.get_columns(); col_index++) {
      ctx.translate(metrics.stack_pad_left,0);
      if (col_index >= offset && col_index < (offset + pspm.get_motif_length())) {
        motif_position = col_index - offset;
        draw_stack_num(ctx, metrics, motif_position);
        draw_stack(ctx, metrics, pspm.get_stack(motif_position, logo.alphabet), raster);
      }
      ctx.translate(metrics.stack_width, 0);
    }
    ctx.restore();//s5
    ////optionally draw name if this is the last row but isn't the only row 
    if (draw_name && (logo.get_rows() != 1 && pspm_i == (logo.get_rows()-1))) {
      //translate vertically past the stack and axis's        
      ctx.translate(0, metrics.y_num_height/2 + metrics.stack_height + 
          Math.max(metrics.y_num_height/2, metrics.x_num_above + metrics.x_num_width + metrics.name_spacer));

      ctx.save();//s6
      ctx.translate(metrics.summed_width/2, metrics.name_height);
      ctx.font = metrics.name_font;
      ctx.textAlign = "center";
      ctx.fillText(pspm.name, 0, 0);
      ctx.restore();//s6
      ctx.translate(0, metrics.name_height);
    } else {
      //translate vertically past the stack and axis's        
      ctx.translate(0, metrics.y_num_height/2 + metrics.stack_height + 
          Math.max(metrics.y_num_height/2, metrics.x_num_above + metrics.x_num_width));
    }
    //if not the last row then add middle padding
    if (pspm_i != (logo.get_rows() -1)) {
      ctx.translate(0, metrics.pad_middle);
    }
  }
  ctx.restore();//s7
  ctx.translate(metrics.summed_width - metrics.pad_right, metrics.summed_height - metrics.pad_bottom);
  ctx.font = metrics.fine_txt_font;
  ctx.textAlign = "right";
  ctx.fillText(logo.fine_text, 0,0);
  ctx.restore();//s2
  ctx.restore();//s1
}

function create_canvas(c_width, c_height, c_id, c_title, c_display) {
  "use strict";
  var canvas = document.createElement("canvas");
  //check for canvas support before attempting anything
  if (!canvas.getContext) {
    return null;
  }
  var ctx = canvas.getContext('2d');
  //check for html5 text drawing support
  if (!supports_text(ctx)) {
    return null;
  }
  //size the canvas
  canvas.width = c_width;
  canvas.height = c_height;
  canvas.id = c_id;
  canvas.title = c_title;
  canvas.style.display = c_display;
  return canvas;
}

function logo_1(alphabet, fine_text, pspm) {
  "use strict";
  var logo = new Logo(alphabet, fine_text);
  logo.add_pspm(pspm);
  return logo;
}

function logo_2(alphabet, fine_text, target, query, query_offset) {
  "use strict";
  var logo = new Logo(alphabet, fine_text);
  if (query_offset < 0) {
    logo.add_pspm(target, -query_offset);
    logo.add_pspm(query);
  } else {
    logo.add_pspm(target);
    logo.add_pspm(query, query_offset);
  }      
  return logo;
}

/*
 * Specifies an alternate source for an image.
 * If the image with the image_id specified has
 * not loaded then a generated logo will be used 
 * to replace it.
 *
 * Note that the image must either have dimensions
 * or a scale must be set.
 */
function alternate_logo(logo, image_id, scale) {
  "use strict";
  var image = document.getElementById(image_id);
  if (!image) {
    alert("Can't find specified image id (" +  image_id + ")");
    return;
  }
  //if the image has loaded then there is no reason to use the canvas
  if (image_ok(image)) {
    return;
  }
  //the image has failed to load so replace it with a canvas if we can.
  var canvas = create_canvas(image.width, image.height, image_id, image.title, image.style.display);
  if (canvas === null) {
    return;
  }
  //draw the logo on the canvas
  draw_logo_on_canvas(logo, canvas, null, scale);
  //replace the image with the canvas
  image.parentNode.replaceChild(canvas, image);
}

/*
 * Specifes that the element with the specified id
 * should be replaced with a generated logo.
 */
function replace_logo(logo, replace_id, scale, title_txt, display_style) {
  "use strict";
  var element = document.getElementById(replace_id);
  if (!replace_id) {
    alert("Can't find specified id (" + replace_id + ")");
    return;
  }
  //found the element!
  var canvas = create_canvas(50, 120, replace_id, title_txt, display_style);
  if (canvas === null) {
    return;
  }
  //draw the logo on the canvas
  draw_logo_on_canvas(logo, canvas, null, scale);
  //replace the element with the canvas
  element.parentNode.replaceChild(canvas, element);
}

/*
 * Fast string trimming implementation found at
 * http://blog.stevenlevithan.com/archives/faster-trim-javascript
 *
 * Note that regex is good at removing leading space but
 * bad at removing trailing space as it has to first go through
 * the whole string.
 */
function trim (str) {
  "use strict";
  var ws, i;
  str = str.replace(/^\s\s*/, '');
  ws = /\s/; i = str.length;
  while (ws.test(str.charAt(--i)));
  return str.slice(0, i + 1);
}
    /* END INCLUDED FILE "motif_logo.js" */
    
  
    
    /* START INCLUDED FILE "dreme-to-html.js" */
      var expansion_lookup = [];

      /*
       * show_hidden
       *
       * Looks for specially named elements and switches to the shown view
       */
      function show_hidden(prefix) {
        document.getElementById(prefix + '_activator').style.display = 'none';
        document.getElementById(prefix + '_deactivator').style.display = 'block';
        document.getElementById(prefix + '_data').style.display = 'block';
      }
      /*
       * hide_shown
       *
       * Looks for specially named elements and switches to the hidden view
       */
      function hide_shown(prefix) {
        document.getElementById(prefix + '_activator').style.display = 'block';
        document.getElementById(prefix + '_deactivator').style.display = 'none';
        document.getElementById(prefix + '_data').style.display = 'none';
      }

      function click_download_tab(tab) {
        document.getElementById("download_tab_num").value = tab;
        for (var i = 1; i <= 3; i++) {
          document.getElementById('download_tab_'+i).className = "tab" + (i==tab ? " activeTab" : "");
          document.getElementById('download_pnl_'+i).style.display = (i==tab ? "block" : "none");
        }
        document.getElementById('download_button').style.visibility = (tab==3 ? "visible" : "hidden");
      }


      /*
       * searches child nodes in depth first order and returns the
       * first it finds with the className specified.
       */
      function find_child_element_by_class(node, className) {
        var patt = new RegExp("\\b" + className + "\\b");

        if (node.nodeType == Node.ELEMENT_NODE && 
            patt.test(node.className)) {
          return node;
        } else {
          var result = null;
          for (var i = 0; i < node.childNodes.length; i++) {
            result = find_child_element_by_class(node.childNodes[i], className);
            if (result != null) break;
          }
          return result;
        }
      }

      function find_parent_element_by_class(node, className) {
        var patt = new RegExp("\\b" + className + "\\b");
        if (node.nodeType == Node.ELEMENT_NODE && 
            patt.test(node.className)) {
          return node;
        } else if (node.parentNode != null) {
          return find_parent_element_by_class(node.parentNode, className);
        }
        return null;
      }

      /*
       * expand
       *
       * Expand the extra data section for a motif.
       */
      function expand(num) {
        // get motif data
        var motif_info = motif_seqs[num];
        var motif_id = motif_info[0];
        var seq = motif_info[1];
        var rcseq = motif_info[2];
        var length = motif_info[3];
        var nsites = motif_info[4];
        var p_hits = motif_info[5];
        var n_hits = motif_info[6];
        var pvalue = motif_info[7];
        var evalue = motif_info[8];
        var uevalue = motif_info[9];
        var matches = motif_info[10];
        // find the location to insert the expanded motif data
        var table = document.getElementById('dreme_motifs');
        var motif_row = document.getElementById('motif_row_' + num);
        var exp_row = table.insertRow(motif_row.rowIndex + 1);
        exp_row.id = 'exp_row_' + num;
        var cell = exp_row.insertCell(0);
        cell.colSpan = 9;
        // create the DOM to insert
        var exp = document.getElementById('expanded_motif').firstChild.cloneNode(true);
        // update fields
        set_content_to_text(find_child_element_by_class(exp, 'name'), seq);
        set_content_to_text(find_child_element_by_class(exp, 'num'), num);
        var img = find_child_element_by_class(exp, 'img_nc');
        img.src = motif_id + "nc_" + seq + ".png";
        var imgrc = find_child_element_by_class(exp, 'img_rc');
        imgrc.src = motif_id + "rc_" + rcseq + ".png";
        // fill in the details
        var details = find_child_element_by_class(exp, 'details');
        set_content_to_text(find_child_element_by_class(details, 'positives'), p_hits);
        set_content_to_text(find_child_element_by_class(details, 'negatives'), n_hits);
        set_content_to_text(find_child_element_by_class(details, 'pvalue'), pvalue);
        set_content_to_text(find_child_element_by_class(details, 'evalue'), evalue);
        set_content_to_text(find_child_element_by_class(details, 'uevalue'), uevalue);
        
        // fill in match table
        var match_row = find_child_element_by_class(exp, 'match');
        var tbody = match_row.parentNode;
        for (var i = 0; i < matches.length; i++) {
          var match = matches[i];
          var cseq = match[0];
          var cpos = match[1];
          var cneg = match[2];
          var cpval = match[3].toExponential(1);
          var ceval = match[4].toExponential(1);
          var row = match_row.cloneNode(true);
          var td_cseq = find_child_element_by_class(row, 'dnaseq');
          set_content_to_text(td_cseq, cseq);
          colour_dna_seq(td_cseq);
          set_content_to_text(find_child_element_by_class(row, 'positives'), cpos);
          set_content_to_text(find_child_element_by_class(row, 'negatives'), cneg);
          set_content_to_text(find_child_element_by_class(row, 'pvalue'), cpval);
          set_content_to_text(find_child_element_by_class(row, 'evalue'), ceval);
          tbody.appendChild(row);
        }
        tbody.removeChild(match_row);
        // append the expanded information
        cell.appendChild(exp);
        // hide the old row
        motif_row.style.display = 'none';
        update_headers();
      }

      function expanded_num(elem) {
        var exp = find_parent_element_by_class(elem, 'expanded_motif');
        var num = parseInt(nodes_text(text_nodes(find_child_element_by_class(exp, 'num'))));
        return num;
      }

      function contract(contained_node) {
        var table = document.getElementById('dreme_motifs');
        var num = expanded_num(contained_node);
        var motif_row = document.getElementById('motif_row_' + num);
        var exp_row = document.getElementById('exp_row_' + num);

        motif_row.style.display = 'table-row';
        table.deleteRow(exp_row.rowIndex);
        update_headers();
      }

      function update_headers() {
        var motif_row_patt = new RegExp("\\bmotif_row\\b");
        var motif_head_patt = new RegExp("\\bmotif_head\\b");
        var table = document.getElementById('dreme_motifs');
        var header = table.tHead.getElementsByTagName('tr')[0];
        header.style.display = 'none';
        var trs = table.tBodies[0].getElementsByTagName('tr');
        var needHeader = true;
        for (var i = 0; i < trs.length; i++) {
          var row = trs[i];
          if (row.style.display == 'none') continue;
          if (motif_row_patt.test(row.className)) {
            if (needHeader) {
              var dupHeader = header.cloneNode(true);
              dupHeader.style.display = 'table-row';
              row.parentNode.insertBefore(dupHeader, row);
              needHeader = false;
              i++;
            }
          } else if (motif_head_patt.test(row.className)) {
            table.deleteRow(row.rowIndex);
            i--;
          } else {
            needHeader = true;
          }
        }
      }

      function set_content_to_text(ele, text) {
        while(ele.hasChildNodes()) {
          ele.removeChild(ele.firstChild);
        }
        ele.appendChild(document.createTextNode(text));
      }

      function both_setup(pos) {
        // get the total number of motifs
        var nmotifs = parseInt(document.getElementById('nmotifs').value, 10);
        // set the motif that we're submitting
        document.getElementById('submit_motif').value = (pos == 0 ? 'all' : pos);
        document.getElementById('send_to_selector').style.display = (pos == 0 ? 'none' : 'block');
        document.getElementById('send_to_title_1').style.display = (pos == 0 ? 'none' : 'block');
        document.getElementById('send_to_title_2').style.display = (pos == 0 ? 'block' : 'none');

        if (pos != 0) {
          // get the information for the position
          var motif_seq = motif_seqs[pos];
          var motif_id = motif_seq[0];
          var seq = motif_seq[1];
          var rcseq = motif_seq[2];
          // set the motif number
          // set the titles of both popups
          set_content_to_text(document.getElementById('send_to_name'), seq);
          set_content_to_text(document.getElementById('download_name'), seq);
          // set the images
          var nc_img = "" + motif_id + "nc_" + seq + ".png";
          var rc_img = "" + motif_id + "rc_" + rcseq + ".png";
          var img;
          img = document.getElementById('send_to_img');
          img.src = nc_img;
          img.style.display = "inline";
          img = document.getElementById('send_to_rcimg');
          img.src = rc_img;
          img.style.display = "inline";
          img = document.getElementById('download_img');
          img.src = nc_img;
          img.style.display = "inline";
          img = document.getElementById('download_rcimg');
          img.src = rc_img;
          img.style.display = "inline";
          // hide the canvas
          document.getElementById('send_to_can').style.display = "none";
          document.getElementById('send_to_rccan').style.display = "none";
          document.getElementById('download_can').style.display = "none";
          document.getElementById('download_rccan').style.display = "none";
          // get some motif details
          var pspm_text = document.getElementById("pspm"+ pos).value;
          var pspm = new Pspm(pspm_text);
          var alpha = new Alphabet(document.getElementById("alphabet").value, 
              document.getElementById("bgfreq").value);
          document.getElementById('download_pspm').value = pspm.as_pspm();
          document.getElementById('download_pssm').value = pspm.as_pssm(alpha);
          // set the width and height defaults
          document.getElementById('logo_width').value = pspm.get_motif_length();
          document.getElementById('logo_height').value = 7.5;
          // hide and show the arrows
          var prevclass = (pos == 1 ? "navarrow inactive" : "navarrow");
          var nextclass = (pos == nmotifs ? "navarrow inactive" : "navarrow");
          document.getElementById('prev_arrow_1').className = prevclass;
          document.getElementById('prev_arrow_2').className = prevclass;
          document.getElementById('next_arrow_1').className = nextclass;
          document.getElementById('next_arrow_2').className = nextclass;
          set_content_to_text(document.getElementById('pop_num_1'), pos);
          set_content_to_text(document.getElementById('pop_num_2'), pos);
        }
      }

      function both_change(inc) {
        var motif_num = parseInt(document.getElementById('submit_motif').value, 10);
        var nmotifs = parseInt(document.getElementById('nmotifs').value, 10);
        var orig = motif_num;
        motif_num += inc;
        if (motif_num > nmotifs) motif_num = nmotifs;
        else if (motif_num < 1) motif_num = 1;
        if (orig != motif_num) both_setup(motif_num);
      }

      function both_hide() {
        document.getElementById('grey_out_page').style.display = 'none';
        document.getElementById('download').style.display = 'none';
        document.getElementById('send_to').style.display = 'none';
      }

      /*
       * lookup the information on a motif and prepare the
       * popup for sending it to another program
       */
      function send_to_popup(pos) {
        both_setup(pos);
        var program = find_child_element_by_class(document.getElementById('programs'), 'selected').id;
        var task = highlight_submit_task(null, submit_programs[program]);
        highlight_submit_program(program, submit_tasks[task]);
        update_submit_text(task, program);
        // show the send to page
        var grey_out = document.getElementById('grey_out_page');
        grey_out.style.display = 'block';
        var send_to_pop = document.getElementById('send_to');
        send_to_pop.style.display = 'block';
      }

      function send_to_popup2(elem) {
        send_to_popup(expanded_num(elem));
      }

      function send_to_submit() {
        var program = find_child_element_by_class(document.getElementById('programs'), 'selected').id;
        // set the hidden fields on the form
        document.getElementById('submit_program').value = program;
        // send the form
        document.getElementById('submit_form').submit();
        both_hide();
      }

      function download_popup(pos) {
        both_setup(pos);
        click_download_tab(document.getElementById("download_tab_num").value);
        document.getElementById('submit_program').value = "LOGO";
        // show the download page
        var grey_out = document.getElementById('grey_out_page');
        grey_out.style.display = 'block';
        var download_pop = document.getElementById('download');
        download_pop.style.display = 'block';
      }

      function download_popup2(elem) {
        download_popup(expanded_num(elem));
      }

      function download_submit() {
        var format = document.getElementById('logo_format').value;
        var orient = document.getElementById('logo_rc').value;
        var ssc = document.getElementById('logo_ssc').value;
        var width = document.getElementById('logo_width').value;
        var height = document.getElementById('logo_height').value;
        document.getElementById('submit_format').value = format;
        document.getElementById('submit_rc').value = orient;
        document.getElementById('submit_ssc').value = ssc;
        document.getElementById('submit_width').value = width;
        document.getElementById('submit_height').value = height;
        document.getElementById('submit_form').submit();
        both_hide();
      }

      function FixLogoTask(num, rc) {
        this.num = num;
        this.rc = rc;
        this.run = FixLogoTask_run;
      }

      function FixLogoTask_run() {
        var pspm_text = document.getElementById("pspm" + this.num).value;
        var alpha = new Alphabet("ACGT");
        var pspm = new Pspm(pspm_text);
        if (this.rc) pspm = pspm.reverse_complement(alpha);
        var imgid = "small_" + (this.rc ? "rc_" : "") + "logo_" + this.num;

        var image = document.getElementById(imgid);

        var canvas = create_canvas(pspm.get_motif_length() *15, 50, image.id, 
            image.title, image.style.display);
        if (canvas == null) return;

        var logo = logo_1(alpha, "DREME", pspm);
        draw_logo_on_canvas(logo, canvas);
        image.parentNode.replaceChild(canvas, image);
      }

      function fix_popup_logo(image, canvasid, rc) {
        var motif_num = parseInt(document.getElementById('submit_motif').value, 10);
        var pspm_text = document.getElementById("pspm" + motif_num).value;
        var alpha = new Alphabet("ACGT");
        var pspm = new Pspm(pspm_text);
        if (rc) pspm = pspm.reverse_complement(alpha);
        image.style.display = "none";
        //check for canvas support before attempting anything
        var canvas = document.getElementById(canvasid);
        if (!canvas.getContext) return;
        if (!supports_text(canvas.getContext('2d'))) return;
        canvas.height = 90;
        canvas.width = 170;
        canvas.style.display = "inline";
        var logo = logo_1(alpha, "DREME", pspm);
        draw_logo_on_canvas(logo, canvas, false);
      }

      function fix_expanded_logo(image, rc) {
        var motif_num = expanded_num(image);
        var pspm_text = document.getElementById("pspm" + motif_num).value;
        var alpha = new Alphabet("ACGT");
        var pspm = new Pspm(pspm_text);
        if (rc) pspm = pspm.reverse_complement(alpha);
        //check for canvas support before attempting anything
        var canvas = document.createElement('canvas');
        if (!canvas.getContext) return;
        if (!supports_text(canvas.getContext('2d'))) return;
        canvas.height = 150;
        canvas.width = 0;
        draw_logo_on_canvas(logo_1(alpha, "DREME", pspm), canvas, false);
        image.parentNode.replaceChild(canvas, image);
      }

      function text_nodes(container) {
        var textNodes = [];
        var stack = [container];
        // depth first search to maintain ordering when flattened 
        while (stack.length > 0) {
          var node = stack.pop();
          if (node.nodeType == Node.TEXT_NODE) {
            textNodes.push(node);
          } else {
            for (var i = node.childNodes.length-1; i >= 0; i--) {
              stack.push(node.childNodes[i]);
            }
          }
        }
        return textNodes;
      }

      function node_text(node) {
        if (node === undefined) {
          return '';
        } else if (node.textContent) {
          return node.textContent;
        } else if (node.innerText) {
          return node.innerText;
        } else {
          return '';
        }
      }

      function nodes_text(nodes, separator) {
        if (separator === undefined) separator = '';
        var text = '';
        if (nodes.length > 0) {
          text += node_text(nodes[0]);
        }
        for (var i = 1; i < nodes.length; i++) {
          text += separator + node_text(nodes[i]);
        }
        return text;
      }

      function colour_dna_seq(container) {
        var textnodes = text_nodes(container);
        for (var i = 0; i < textnodes.length; i++) {
          var node = textnodes[i];
          container.replaceChild(create_dna_seq(node_text(node)), node);
        }
      }

      function create_dna_seq(seq) {
        var out = document.createElement('span');
        var last = 0;
        for (var i = 0; i < seq.length; i++) {
          var letter = seq.charAt(i);
          if (letter == 'A' || letter == 'C' || letter == 'G' || letter == 'T') { 
            if (last < i) {
              out.appendChild(document.createTextNode(seq.substring(last, i)));
            }
            var coloured_letter = document.createElement('span');
            coloured_letter.className = "dna_" + letter;
            coloured_letter.appendChild(document.createTextNode(letter));
            out.appendChild(coloured_letter);
            last = i + 1;
          }
        }
        if (last < seq.length) {
          out.appendChild(document.createTextNode(seq.substring(last)));
        }
        return out;
      }

      function sort_table(colEle, compare_function) {
        //find the parent of colEle that is either a td or th
        var cell = colEle;
        while (true) {
          if (cell == null) return;
          if (cell.nodeType == Node.ELEMENT_NODE && 
              (cell.tagName.toLowerCase() == "td" || cell.tagName.toLowerCase() == "th")) {
            break;
          }
          cell = cell.parentNode;
        }
        //find the parent of cell that is a tr
        var row = cell;
        while (true) {
          if (row == null) return;
          if (row.nodeType == Node.ELEMENT_NODE && row.tagName.toLowerCase() == "tr") {
            break;
          }
          row = row.parentNode;
        }
        //find the parent of row that is a table
        var table = row;
        while (true) {
          if (table == null) return;
          if (table.nodeType == Node.ELEMENT_NODE && table.tagName.toLowerCase() == "table") {
            break;
          }
          table = table.parentNode;
        }
        var column_index = cell.cellIndex;
        // do a bubble sort, because the tables are so small it doesn't matter
        var change;
        var trs = table.tBodies[0].getElementsByTagName('tr');
        var already_sorted = true;
        var reverse = false;
        while (true) {
          do {
            change = false;
            for (var i = 0; i < trs.length -1; i++) {
              var v1 = nodes_text(text_nodes(trs[i].cells[column_index]));
              var v2 = nodes_text(text_nodes(trs[i+1].cells[column_index]));
              if (reverse) {
                var tmp = v1;
                v1 = v2;
                v2 = tmp;
              }
              if (compare_function(v1, v2) > 0) {
                exchange(trs[i], trs[i+1], table);
                change = true;
                already_sorted = false;
                trs = table.tBodies[0].getElementsByTagName('tr');
              }
            }
          } while (change);
          if (reverse) break;// we've sorted twice so exit
          if (!already_sorted) break;// sort did something so exit
          // when it's sorted one way already then sort the opposite way
          reverse = true;
        }
        update_sort_arrows(row, column_index, reverse);
      }

      function update_sort_arrows(row, column_index, reverse) {
        var ascending = "\u25BC";
        var descending = "\u25B2";
        var dir = (reverse ? descending : ascending);
        for (var i = 0; i < row.cells.length; i++) {
          var arrow = find_child_element_by_class(row.cells[i], "sort_dir");
          if (arrow == null) continue;
          if (i == column_index) {
            set_content_to_text(arrow, dir);
          } else {
            set_content_to_text(arrow, "");
          }
        }
      }
    
      function exchange(oRowI, oRowJ, oTable) {
        var i = oRowI.rowIndex;
        var j = oRowJ.rowIndex;
         if (i == j+1) {
          oTable.tBodies[0].insertBefore(oRowI, oRowJ);
        } if (j == i+1) {
          oTable.tBodies[0].insertBefore(oRowJ, oRowI);
        } else {
            var tmpNode = oTable.tBodies[0].replaceChild(oRowI, oRowJ);
            if(typeof(oRowI) != "undefined") {
              oTable.tBodies[0].insertBefore(tmpNode, oRowI);
            } else {
              oTable.appendChild(tmpNode);
            }
        }
      }

      function compare_numbers(v1, v2) {
        var f1 = parseFloat(v1);
        var f2 = parseFloat(v2);
        if (f1 < f2) {
          return -1;
        } else if (f1 > f2) {
          return 1;
        } else {
          return 0;
        }
      }

      function compare_counts(v1, v2) {
        var re = /(\d+)\/\d+/;
        var m1 = re.exec(v1);
        var m2 = re.exec(v2);
        if (m1 == null && m2 == null) return 0;
        if (m1 == null) return -1;
        if (m2 == null) return 1;
        return compare_numbers(m1[1], m2[1]);
      }

      function compare_strings(v1, v2) {
        return v1.localeCompare(v2);
      }
      /*
       * coords
       *
       * Calculates the x and y offset of an element.
       * From http://www.quirksmode.org/js/findpos.html
       */
      function coords(elem) {
        var myX = myY = 0;
        if (elem.offsetParent) {
          do {
            myX += elem.offsetLeft;
            myY += elem.offsetTop;
          } while (elem = elem.offsetParent);
        }
        return [myX, myY];
      }
      /*
       * help
       *
       * Moves around help pop-ups so they appear
       * below an activator.
       */
      function help(activator, popup_id) {
        if (help.popup === undefined) {
          help.popup = null;
        }
        if (help.activator === undefined) {
          help.activator = null;
        }

        if (typeof(activator) == 'undefined') { // no activator so hide
          help.popup.style.display = 'none';
          help.popup = null;
          return;
        }
        var pop = document.getElementById(popup_id);
        if (pop == help.popup) {
          if (activator == help.activator) {
            //hide popup (as we've already shown it for the current help button)
            help.popup.style.display = 'none';
            help.popup = null;
            return; // toggling complete!
          }
        } else if (help.popup != null) {
          //activating different popup so hide current one
          help.popup.style.display = 'none';
        }
        help.popup = pop;
        help.activator = activator;

        //must make the popup visible to measure it or it has zero width
        pop.style.display = 'block';
        var xy = coords(activator);
        var padding = 10;
        var edge_padding = 15;
        var scroll_padding = 15;

        var pop_left = (xy[0] + (activator.offsetWidth / 2)  - (pop.offsetWidth / 2));
        var pop_top = (xy[1] + activator.offsetHeight + padding);

        // ensure the box is not past the top or left of the page
        if (pop_left < 0) pop_left = edge_padding;
        if (pop_top < 0) pop_top = edge_padding;
        // ensure the box does not cause horizontal scroll bars
        var page_width = null;
        if (window.innerWidth) {
          page_width = window.innerWidth;
        } else if (document.body) {
          page_width = document.body.clientWidth;
        }
        if (page_width) {
          if (pop_left + pop.offsetWidth > page_width) {
            pop_left = page_width - pop.offsetWidth - edge_padding - scroll_padding; //account for scrollbars
          }
        }

        pop.style.left = pop_left + "px";
        pop.style.top = pop_top + "px";
      }

      var submit_tasks = [];
      submit_tasks['search_motifs'] = ['TOMTOM'];
      submit_tasks['search_sequences'] = ['FIMO'];
      submit_tasks['rank_sequences'] = ['MAST'];
      submit_tasks['predict_go'] = ['GOMO'];
      submit_tasks['infer_tf'] = ['SPAMO'];
      var submit_programs = [];
      submit_programs['TOMTOM'] = ['search_motifs'];
      submit_programs['FIMO'] = ['search_sequences'];
      submit_programs['MAST'] = ['rank_sequences'];
      submit_programs['GOMO'] = ['predict_go'];
      submit_programs['SPAMO'] = ['infer_tf'];
      var submit_descriptions = [];
      submit_descriptions['TOMTOM'] = "Find similar motifs in published " + 
          "libraries or a library you supply.";
      submit_descriptions['FIMO'] = "Find motif occurences in sequence data.";
      submit_descriptions['MAST'] = "Rank sequences by affinity to groups " + 
          "of motifs.";
      submit_descriptions['GOMO'] = "Identify possible roles (Gene Ontology " + 
          "terms) for motifs.";
      submit_descriptions['SPAMO'] = "Find other motifs that are enriched at " +
          "specific close spacings which might imply the existance of a complex.";


      function click_submit_task(ele) {
        var task = ele.id;
        var program = highlight_submit_program(null, submit_tasks[task]);
        highlight_submit_task(task, submit_programs[program]);
        update_submit_text(task, program);
      }

      function click_submit_program(ele) {
        var program = ele.id;
        var task = highlight_submit_task(null, submit_programs[program]);
        highlight_submit_program(program, submit_tasks[task]);
        update_submit_text(task, program);
      }

      function update_submit_text(task, program) {
        var task_ele = document.getElementById(task);
        var program_ele = document.getElementById(program);
        set_content_to_text(document.getElementById('program_action'), 
            nodes_text(text_nodes(task_ele)));
        set_content_to_text(document.getElementById('program_name'), 
            nodes_text(text_nodes(program_ele)));
        set_content_to_text(document.getElementById('program_desc'), 
            submit_descriptions[program]);
      }

      function highlight_submit_task(select, highlights) {
        var tasks_ul = document.getElementById('tasks');
        var all_tasks = tasks_ul.getElementsByTagName('li');
        var li;
        var originally_selected = null;
        // deselect everything in the tasks list
        for (var i = 0; i < all_tasks.length; i++) {
          li = all_tasks[i];
          if (li.className == "selected") {
            originally_selected = li;
          }
          li.className = "";
        }
        // highlight everything in the highlights list
        for (var i = 0; i < highlights.length; i++) {
          var li = document.getElementById(highlights[i]);
          li.className = "active";
        }
        // check if we're setting the selected item specifically
        if (select != null) {
          li = document.getElementById(select);
          li.className = "selected";
          return select;
        } else {
          // if the originally selected item is allowed then keep it
          // otherwise move to the first element of the highlight list
          if (originally_selected != null && 
              originally_selected.className == "active") {
            originally_selected.className = "selected";
            return originally_selected.id;
          } else if (highlights.length > 0) {
            li = document.getElementById(highlights[0]);
            li.className = "selected";
            return highlights[0];
          }
          return null;
        }
      }


      function highlight_submit_program(select, highlights) {
        var programs_ul = document.getElementById('programs');
        var all_programs = programs_ul.getElementsByTagName('li');
        var li;
        var originally_selected = null;
        // deselect everything in the programs list
        for (var i = 0; i < all_programs.length; i++) {
          li = all_programs[i];
          if (li.className == "selected") {
            originally_selected = li;
          }
          li.className = "";
        }
        // highlight everything in the highlights list
        for (var i = 0; i < highlights.length; i++) {
          var li = document.getElementById(highlights[i]);
          li.className = "active";
        }
        // check if we're setting the selected item specifically
        if (select != null) {
          li = document.getElementById(select);
          li.className = "selected";
          return select;
        } else {
          // if the originally selected item is allowed then keep it
          // otherwise move to the first element of the highlight list
          if (originally_selected != null && 
              originally_selected.className == "active") {
            originally_selected.className = "selected";
            return originally_selected.id;
          } else if (highlights.length > 0) {
            li = document.getElementById(highlights[0]);
            li.className = "selected";
            return highlights[0];
          }
          return null;
        }
      }

      //
      // See http://stackoverflow.com/questions/814613/how-to-read-get-data-from-a-url-using-javascript
      // Slightly modified with information from
      // https://developer.mozilla.org/en/DOM/window.location
      //
      function parse_params() {
        var search = window.location.search;
        var queryStart = search.indexOf("?") + 1;
        var queryEnd   = search.indexOf("#") + 1 || search.length + 1;
        var query      = search.slice(queryStart, queryEnd - 1);
        var params  = {};

        if (query === search || query === "") return params;

        var nvPairs = query.replace(/\+/g, " ").split("&");

        for (var i=0; i<nvPairs.length; i++) {
          var nv = nvPairs[i].split("=");
          var n  = decodeURIComponent(nv[0]);
          var v  = decodeURIComponent(nv[1]);
          // allow a name to be used multiple times
          // storing each value in the array
          if ( !(n in params) ) {
            params[n] = [];
          }
          params[n].push(nv.length === 2 ? v : null);
        }
        return params;
      }

      /*
       * page_loaded
       *
       * Called when the page has loaded for the first time.
       */
      function page_loaded() {
        post_load_setup();
      }

      /*
       * page_loaded
       *
       * Called when a cached page is reshown.
       */
      function page_shown(e) {
        if (e.persisted) post_load_setup();
      }

      /*
       * post_load_setup
       *
       * Setup state that is dependant on everything having been loaded already.
       */
      function post_load_setup() {
        update_scrollpad();
        var params = parse_params();
        if (params["more"]) {
          var seq_to_num = {};
          for (var i = 0; i < motif_seqs.length; i++) {
            if (motif_seqs[i]) {
              seq_to_num[motif_seqs[i][1]] = i;
            }
          }
          var more_list = params["more"];
          for (var i = 0; i < more_list.length; i++) {
            var num = seq_to_num[more_list[i]];
            if (num !== undefined) {
              expand(num);
              var exp_row = document.getElementById('exp_row_' + num);
              exp_row.scrollIntoView(true);
            }
          }
          
        }
      }

      /*
       * update_scrollpad
       *
       * Creates padding at the bottom of the page to allow
       * scrolling of anything into view.
       */
      function update_scrollpad() {
        var elem = (document.compatMode === "CSS1Compat") ? 
            document.documentElement : document.body;
        document.getElementById("scrollpad").style.height = Math.abs(elem.clientHeight - 100) + "px";
      }

    /* END INCLUDED FILE "dreme-to-html.js" */
    
  </script>
</head>
<body onload="page_loaded()" onpageshow="page_shown(event)" onresize="update_scrollpad()">
<form id="submit_form" method="post" action="http://meme-suite.org/utilities/meme_request" target="_blank">
<!--+++++++++++++++START DATA+++++++++++++++-->
<input type="hidden" name="version" value="MEME version 4.10.2">
<input type="hidden" name="alphabet" id="alphabet" value="ACGT">
<input type="hidden" name="strands" value="+ -">
<input type="hidden" name="bgsrc" value="dataset">
<input type="hidden" name="bgfreq" id="bgfreq" value="A 0.298 C 0.143 G 0.071 T 0.488">
<input type="hidden" name="name" value="Only HuR Clusters">
<input type="hidden" name="nmotifs" id="nmotifs" value="49">
<!--data for motif 1-->
<input type="hidden" id="motifblock1" name="motifname1" value="AVAAMAA">
<input type="hidden" id="pspm1" name="pspm1" value="
letter-probability matrix: alength= 4 w= 7 nsites= 2062 E= 3.0e-326
1.000000 0.000000 0.000000 0.000000
0.658584 0.129971 0.211445 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.806014 0.193986 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 2-->
<input type="hidden" id="motifblock2" name="motifname2" value="BWVAAAA">
<input type="hidden" id="pspm2" name="pspm2" value="
letter-probability matrix: alength= 4 w= 7 nsites= 1820 E= 5.6e-128
0.000000 0.175824 0.262637 0.561538
0.491209 0.000000 0.000000 0.508791
0.529670 0.186813 0.283516 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 3-->
<input type="hidden" id="motifblock3" name="motifname3" value="AARCANW">
<input type="hidden" id="pspm3" name="pspm3" value="
letter-probability matrix: alength= 4 w= 7 nsites= 762 E= 1.2e-105
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.652231 0.000000 0.347769 0.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.338583 0.137795 0.217848 0.305774
0.541995 0.000000 0.000000 0.458005
">
<!--data for motif 4-->
<input type="hidden" id="motifblock4" name="motifname4" value="ANSAAAR">
<input type="hidden" id="pspm4" name="pspm4" value="
letter-probability matrix: alength= 4 w= 7 nsites= 856 E= 6.2e-066
1.000000 0.000000 0.000000 0.000000
0.353972 0.096963 0.232477 0.316589
0.000000 0.299065 0.700935 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.688084 0.000000 0.311916 0.000000
">
<!--data for motif 5-->
<input type="hidden" id="motifblock5" name="motifname5" value="HTTCWGW">
<input type="hidden" id="pspm5" name="pspm5" value="
letter-probability matrix: alength= 4 w= 7 nsites= 353 E= 3.3e-056
0.373938 0.249292 0.000000 0.376771
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 1.000000 0.000000 0.000000
0.532578 0.000000 0.000000 0.467422
0.000000 0.000000 1.000000 0.000000
0.487252 0.000000 0.000000 0.512748
">
<!--data for motif 6-->
<input type="hidden" id="motifblock6" name="motifname6" value="TTTGNAW">
<input type="hidden" id="pspm6" name="pspm6" value="
letter-probability matrix: alength= 4 w= 7 nsites= 304 E= 4.6e-036
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 1.000000 0.000000
0.220395 0.230263 0.203947 0.345395
1.000000 0.000000 0.000000 0.000000
0.569079 0.000000 0.000000 0.430921
">
<!--data for motif 7-->
<input type="hidden" id="motifblock7" name="motifname7" value="AADDTCA">
<input type="hidden" id="pspm7" name="pspm7" value="
letter-probability matrix: alength= 4 w= 7 nsites= 288 E= 7.7e-027
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.392361 0.000000 0.204861 0.402778
0.357639 0.000000 0.225694 0.416667
0.000000 0.000000 0.000000 1.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 8-->
<input type="hidden" id="motifblock8" name="motifname8" value="AGACADW">
<input type="hidden" id="pspm8" name="pspm8" value="
letter-probability matrix: alength= 4 w= 7 nsites= 144 E= 1.0e-024
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.402778 0.000000 0.236111 0.361111
0.458333 0.000000 0.000000 0.541667
">
<!--data for motif 9-->
<input type="hidden" id="motifblock9" name="motifname9" value="AANWGCA">
<input type="hidden" id="pspm9" name="pspm9" value="
letter-probability matrix: alength= 4 w= 7 nsites= 166 E= 4.0e-027
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.313253 0.198795 0.204819 0.283133
0.409639 0.000000 0.000000 0.590361
0.000000 0.000000 1.000000 0.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 10-->
<input type="hidden" id="motifblock10" name="motifname10" value="DGAAACW">
<input type="hidden" id="pspm10" name="pspm10" value="
letter-probability matrix: alength= 4 w= 7 nsites= 130 E= 2.1e-022
0.430769 0.000000 0.261538 0.307692
0.000000 0.000000 1.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
0.384615 0.000000 0.000000 0.615385
">
<!--data for motif 11-->
<input type="hidden" id="motifblock11" name="motifname11" value="CTHHAAG">
<input type="hidden" id="pspm11" name="pspm11" value="
letter-probability matrix: alength= 4 w= 7 nsites= 156 E= 1.0e-020
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.378205 0.307692 0.000000 0.314103
0.365385 0.243590 0.000000 0.391026
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
">
<!--data for motif 12-->
<input type="hidden" id="motifblock12" name="motifname12" value="HCATTTS">
<input type="hidden" id="pspm12" name="pspm12" value="
letter-probability matrix: alength= 4 w= 7 nsites= 195 E= 3.0e-020
0.343590 0.235897 0.000000 0.420513
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.635897 0.364103 0.000000
">
<!--data for motif 13-->
<input type="hidden" id="motifblock13" name="motifname13" value="CWGAGAD">
<input type="hidden" id="pspm13" name="pspm13" value="
letter-probability matrix: alength= 4 w= 7 nsites= 112 E= 4.2e-021
0.000000 1.000000 0.000000 0.000000
0.491071 0.000000 0.000000 0.508929
0.000000 0.000000 1.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.455357 0.000000 0.232143 0.312500
">
<!--data for motif 14-->
<input type="hidden" id="motifblock14" name="motifname14" value="CAKDAAG">
<input type="hidden" id="pspm14" name="pspm14" value="
letter-probability matrix: alength= 4 w= 7 nsites= 116 E= 6.5e-017
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 0.405172 0.594828
0.379310 0.000000 0.284483 0.336207
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
">
<!--data for motif 15-->
<input type="hidden" id="motifblock15" name="motifname15" value="ARTNACA">
<input type="hidden" id="pspm15" name="pspm15" value="
letter-probability matrix: alength= 4 w= 7 nsites= 205 E= 1.8e-015
1.000000 0.000000 0.000000 0.000000
0.619512 0.000000 0.380488 0.000000
0.000000 0.000000 0.000000 1.000000
0.312195 0.190244 0.160976 0.336585
1.000000 0.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 16-->
<input type="hidden" id="motifblock16" name="motifname16" value="CTGTDWA">
<input type="hidden" id="pspm16" name="pspm16" value="
letter-probability matrix: alength= 4 w= 7 nsites= 118 E= 7.3e-016
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 1.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.550847 0.000000 0.135593 0.313559
0.500000 0.000000 0.000000 0.500000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 17-->
<input type="hidden" id="motifblock17" name="motifname17" value="AARTCAD">
<input type="hidden" id="pspm17" name="pspm17" value="
letter-probability matrix: alength= 4 w= 7 nsites= 114 E= 8.0e-014
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.657895 0.000000 0.342105 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.377193 0.000000 0.271930 0.350877
">
<!--data for motif 18-->
<input type="hidden" id="motifblock18" name="motifname18" value="CATTGBW">
<input type="hidden" id="pspm18" name="pspm18" value="
letter-probability matrix: alength= 4 w= 7 nsites= 85 E= 1.1e-012
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 1.000000 0.000000
0.000000 0.188235 0.294118 0.517647
0.600000 0.000000 0.000000 0.400000
">
<!--data for motif 19-->
<input type="hidden" id="motifblock19" name="motifname19" value="ARAACWT">
<input type="hidden" id="pspm19" name="pspm19" value="
letter-probability matrix: alength= 4 w= 7 nsites= 103 E= 4.3e-012
1.000000 0.000000 0.000000 0.000000
0.592233 0.000000 0.407767 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
0.349515 0.000000 0.000000 0.650485
0.000000 0.000000 0.000000 1.000000
">
<!--data for motif 20-->
<input type="hidden" id="motifblock20" name="motifname20" value="TWCTTGW">
<input type="hidden" id="pspm20" name="pspm20" value="
letter-probability matrix: alength= 4 w= 7 nsites= 66 E= 1.1e-010
0.000000 0.000000 0.000000 1.000000
0.651515 0.000000 0.000000 0.348485
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 1.000000 0.000000
0.469697 0.000000 0.000000 0.530303
">
<!--data for motif 21-->
<input type="hidden" id="motifblock21" name="motifname21" value="CTTTSWC">
<input type="hidden" id="pspm21" name="pspm21" value="
letter-probability matrix: alength= 4 w= 7 nsites= 81 E= 2.3e-009
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.666667 0.333333 0.000000
0.308642 0.000000 0.000000 0.691358
0.000000 1.000000 0.000000 0.000000
">
<!--data for motif 22-->
<input type="hidden" id="motifblock22" name="motifname22" value="CATGWDA">
<input type="hidden" id="pspm22" name="pspm22" value="
letter-probability matrix: alength= 4 w= 7 nsites= 78 E= 4.7e-011
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 1.000000 0.000000
0.474359 0.000000 0.000000 0.525641
0.346154 0.000000 0.230769 0.423077
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 23-->
<input type="hidden" id="motifblock23" name="motifname23" value="CTRGAAR">
<input type="hidden" id="pspm23" name="pspm23" value="
letter-probability matrix: alength= 4 w= 7 nsites= 67 E= 2.0e-010
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.447761 0.000000 0.552239 0.000000
0.000000 0.000000 1.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.597015 0.000000 0.402985 0.000000
">
<!--data for motif 24-->
<input type="hidden" id="motifblock24" name="motifname24" value="TRMACAA">
<input type="hidden" id="pspm24" name="pspm24" value="
letter-probability matrix: alength= 4 w= 7 nsites= 67 E= 1.5e-009
0.000000 0.000000 0.000000 1.000000
0.597015 0.000000 0.402985 0.000000
0.552239 0.447761 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 25-->
<input type="hidden" id="motifblock25" name="motifname25" value="CTTRAGW">
<input type="hidden" id="pspm25" name="pspm25" value="
letter-probability matrix: alength= 4 w= 7 nsites= 56 E= 2.5e-008
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.625000 0.000000 0.375000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
0.428571 0.000000 0.000000 0.571429
">
<!--data for motif 26-->
<input type="hidden" id="motifblock26" name="motifname26" value="AAACSAR">
<input type="hidden" id="pspm26" name="pspm26" value="
letter-probability matrix: alength= 4 w= 7 nsites= 52 E= 2.7e-007
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
0.000000 0.634615 0.365385 0.000000
1.000000 0.000000 0.000000 0.000000
0.576923 0.000000 0.423077 0.000000
">
<!--data for motif 27-->
<input type="hidden" id="motifblock27" name="motifname27" value="CWGATWA">
<input type="hidden" id="pspm27" name="pspm27" value="
letter-probability matrix: alength= 4 w= 7 nsites= 80 E= 1.7e-007
0.000000 1.000000 0.000000 0.000000
0.500000 0.000000 0.000000 0.500000
0.000000 0.000000 1.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.600000 0.000000 0.000000 0.400000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 28-->
<input type="hidden" id="motifblock28" name="motifname28" value="CTMTGTW">
<input type="hidden" id="pspm28" name="pspm28" value="
letter-probability matrix: alength= 4 w= 7 nsites= 57 E= 9.0e-007
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.578947 0.421053 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 1.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.578947 0.000000 0.000000 0.421053
">
<!--data for motif 29-->
<input type="hidden" id="motifblock29" name="motifname29" value="ARAYTGG">
<input type="hidden" id="pspm29" name="pspm29" value="
letter-probability matrix: alength= 4 w= 7 nsites= 62 E= 2.1e-006
1.000000 0.000000 0.000000 0.000000
0.725806 0.000000 0.274194 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.338710 0.000000 0.661290
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 1.000000 0.000000
0.000000 0.000000 1.000000 0.000000
">
<!--data for motif 30-->
<input type="hidden" id="motifblock30" name="motifname30" value="AGAAYCW">
<input type="hidden" id="pspm30" name="pspm30" value="
letter-probability matrix: alength= 4 w= 7 nsites= 53 E= 2.9e-006
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.415094 0.000000 0.584906
0.000000 1.000000 0.000000 0.000000
0.490566 0.000000 0.000000 0.509434
">
<!--data for motif 31-->
<input type="hidden" id="motifblock31" name="motifname31" value="CCCWCMC">
<input type="hidden" id="pspm31" name="pspm31" value="
letter-probability matrix: alength= 4 w= 7 nsites= 60 E= 5.3e-006
0.000000 1.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
0.450000 0.000000 0.000000 0.550000
0.000000 1.000000 0.000000 0.000000
0.333333 0.666667 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
">
<!--data for motif 32-->
<input type="hidden" id="motifblock32" name="motifname32" value="TARCTSA">
<input type="hidden" id="pspm32" name="pspm32" value="
letter-probability matrix: alength= 4 w= 7 nsites= 58 E= 1.5e-005
0.000000 0.000000 0.000000 1.000000
1.000000 0.000000 0.000000 0.000000
0.620690 0.000000 0.379310 0.000000
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.551724 0.448276 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 33-->
<input type="hidden" id="motifblock33" name="motifname33" value="TAAGCTB">
<input type="hidden" id="pspm33" name="pspm33" value="
letter-probability matrix: alength= 4 w= 7 nsites= 31 E= 3.8e-005
0.000000 0.000000 0.000000 1.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.225806 0.354839 0.419355
">
<!--data for motif 34-->
<input type="hidden" id="motifblock34" name="motifname34" value="TAWWGCA">
<input type="hidden" id="pspm34" name="pspm34" value="
letter-probability matrix: alength= 4 w= 7 nsites= 55 E= 7.6e-005
0.000000 0.000000 0.000000 1.000000
1.000000 0.000000 0.000000 0.000000
0.309091 0.000000 0.000000 0.690909
0.581818 0.000000 0.000000 0.418182
0.000000 0.000000 1.000000 0.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 35-->
<input type="hidden" id="motifblock35" name="motifname35" value="ACGTDTA">
<input type="hidden" id="pspm35" name="pspm35" value="
letter-probability matrix: alength= 4 w= 7 nsites= 30 E= 8.9e-006
1.000000 0.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.466667 0.000000 0.266667 0.266667
0.000000 0.000000 0.000000 1.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 36-->
<input type="hidden" id="motifblock36" name="motifname36" value="AACHCTG">
<input type="hidden" id="pspm36" name="pspm36" value="
letter-probability matrix: alength= 4 w= 7 nsites= 34 E= 1.3e-004
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
0.323529 0.264706 0.000000 0.411765
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 1.000000 0.000000
">
<!--data for motif 37-->
<input type="hidden" id="motifblock37" name="motifname37" value="VTGGCAW">
<input type="hidden" id="pspm37" name="pspm37" value="
letter-probability matrix: alength= 4 w= 7 nsites= 56 E= 4.1e-008
0.410714 0.321429 0.267857 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 1.000000 0.000000
0.000000 0.000000 1.000000 0.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.589286 0.000000 0.000000 0.410714
">
<!--data for motif 38-->
<input type="hidden" id="motifblock38" name="motifname38" value="ASTGCWA">
<input type="hidden" id="pspm38" name="pspm38" value="
letter-probability matrix: alength= 4 w= 7 nsites= 40 E= 5.6e-006
1.000000 0.000000 0.000000 0.000000
0.000000 0.550000 0.450000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 1.000000 0.000000
0.000000 1.000000 0.000000 0.000000
0.500000 0.000000 0.000000 0.500000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 39-->
<input type="hidden" id="motifblock39" name="motifname39" value="CCAANCC">
<input type="hidden" id="pspm39" name="pspm39" value="
letter-probability matrix: alength= 4 w= 7 nsites= 37 E= 2.7e-004
0.000000 1.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.270270 0.243243 0.297297 0.189189
0.000000 1.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
">
<!--data for motif 40-->
<input type="hidden" id="motifblock40" name="motifname40" value="CAARTTK">
<input type="hidden" id="pspm40" name="pspm40" value="
letter-probability matrix: alength= 4 w= 7 nsites= 72 E= 7.8e-005
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.638889 0.000000 0.361111 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.291667 0.708333
">
<!--data for motif 41-->
<input type="hidden" id="motifblock41" name="motifname41" value="ATGWRCA">
<input type="hidden" id="pspm41" name="pspm41" value="
letter-probability matrix: alength= 4 w= 7 nsites= 51 E= 3.7e-004
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 1.000000 0.000000
0.490196 0.000000 0.000000 0.509804
0.627451 0.000000 0.372549 0.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 42-->
<input type="hidden" id="motifblock42" name="motifname42" value="CCMMAAA">
<input type="hidden" id="pspm42" name="pspm42" value="
letter-probability matrix: alength= 4 w= 7 nsites= 54 E= 3.5e-003
0.000000 1.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
0.537037 0.462963 0.000000 0.000000
0.592593 0.407407 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 43-->
<input type="hidden" id="motifblock43" name="motifname43" value="HAAGGCA">
<input type="hidden" id="pspm43" name="pspm43" value="
letter-probability matrix: alength= 4 w= 7 nsites= 44 E= 7.2e-003
0.340909 0.204545 0.000000 0.454545
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
0.000000 0.000000 1.000000 0.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 44-->
<input type="hidden" id="motifblock44" name="motifname44" value="CTYTRCC">
<input type="hidden" id="pspm44" name="pspm44" value="
letter-probability matrix: alength= 4 w= 7 nsites= 59 E= 2.0e-004
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.508475 0.000000 0.491525
0.000000 0.000000 0.000000 1.000000
0.593220 0.000000 0.406780 0.000000
0.000000 1.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
">
<!--data for motif 45-->
<input type="hidden" id="motifblock45" name="motifname45" value="CHTTCAG">
<input type="hidden" id="pspm45" name="pspm45" value="
letter-probability matrix: alength= 4 w= 7 nsites= 25 E= 4.9e-003
0.000000 1.000000 0.000000 0.000000
0.280000 0.280000 0.000000 0.440000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
">
<!--data for motif 46-->
<input type="hidden" id="motifblock46" name="motifname46" value="CAAGATD">
<input type="hidden" id="pspm46" name="pspm46" value="
letter-probability matrix: alength= 4 w= 7 nsites= 36 E= 1.8e-002
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.416667 0.000000 0.222222 0.361111
">
<!--data for motif 47-->
<input type="hidden" id="motifblock47" name="motifname47" value="CAGTARA">
<input type="hidden" id="pspm47" name="pspm47" value="
letter-probability matrix: alength= 4 w= 7 nsites= 36 E= 1.8e-002
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
0.000000 0.000000 0.000000 1.000000
1.000000 0.000000 0.000000 0.000000
0.694444 0.000000 0.305556 0.000000
1.000000 0.000000 0.000000 0.000000
">
<!--data for motif 48-->
<input type="hidden" id="motifblock48" name="motifname48" value="ACAATKG">
<input type="hidden" id="pspm48" name="pspm48" value="
letter-probability matrix: alength= 4 w= 7 nsites= 20 E= 4.2e-002
1.000000 0.000000 0.000000 0.000000
0.000000 1.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.400000 0.600000
0.000000 0.000000 1.000000 0.000000
">
<!--data for motif 49-->
<input type="hidden" id="motifblock49" name="motifname49" value="CTTSGTA">
<input type="hidden" id="pspm49" name="pspm49" value="
letter-probability matrix: alength= 4 w= 7 nsites= 17 E= 4.8e-002
0.000000 1.000000 0.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.000000 0.000000 1.000000
0.000000 0.470588 0.529412 0.000000
0.000000 0.000000 1.000000 0.000000
0.000000 0.000000 0.000000 1.000000
1.000000 0.000000 0.000000 0.000000
">
<!--+++++++++++++++FINISHED DATA++++++++++++-->
<input type="hidden" name="program" id="submit_program" value="TOMTOM"><input type="hidden" name="motif" id="submit_motif" value="all"><input type="hidden" name="logoformat" id="submit_format" value="png"><input type="hidden" name="logorc" id="submit_rc" value="false"><input type="hidden" name="logossc" id="submit_ssc" value="false"><input type="hidden" name="logowidth" id="submit_width" value=""><input type="hidden" name="logoheight" id="submit_height" value="7.5">
</form>
<div class="pop_content" id="pop_motifs_name">
<p>
        The name of the motif uses the IUPAC codes for nucleotides which has 
        a different letter to represent each of the 15 possible combinations.
      </p>
<p>
        The name is itself a representation of the motif though the position
        weight matrix is not directly equalivant as it is generated from the
        sites found that matched the letters given in the name.
      </p>
<p><a href="http://meme-suite.org/doc/alphabets.html">
        Read more about the MEME suite's use of the IUPAC alphabets.
        </a></p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motifs_logo">
<p>The logo of the motif.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motifs_rc_logo">
<p>The logo of the reverse complement motif.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motifs_evalue">
<p>The E-value is the enrichment p-value times the number of candidate 
        motifs tested.</p>
<p>The enrichment p-value is calculated using Fisher's Exact Test for 
        enrichment of the motif in the positive sequences.</p>
<p>Note that the counts used in Fisher's Exact Test are made after 
        erasing sites that match previously found motifs.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motifs_uevalue">
<p>The E-value of the motif calculated without erasing the sites of 
        previously found motifs.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_more">
<p>Show more information on the motif.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_submit">
<p>Submit your motif to another MEME Suite program.</p>
<h5>Supported Programs</h5>
<dl>
<dt>Tomtom</dt>
<dd>Tomtom is a tool for searching for similar known motifs. 
          [<a href="http://meme-suite.org/doc/tomtom.html?man_type=web">manual</a>]</dd>
<dt>MAST</dt>
<dd>MAST is a tool for searching biological sequence databases for 
          sequences that contain one or more of a group of known motifs.
          [<a href="http://meme-suite.org/doc/mast.html?man_type=web">manual</a>]</dd>
<dt>FIMO</dt>
<dd>FIMO is a tool for searching biological sequence databases for 
          sequences that contain one or more known motifs.
          [<a href="http://meme-suite.org/doc/fimo.html?man_type=web">manual</a>]</dd>
<dt>GOMO</dt>
<dd>GOMO is a tool for identifying possible roles (Gene Ontology 
          terms) for DNA binding motifs.
          [<a href="http://meme-suite.org/doc/gomo.html?man_type=web">manual</a>]</dd>
<dt>SpaMo</dt>
<dd>SpaMo is a tool for inferring possible transcription factor
          complexes by finding motifs with enriched spacings.
          [<a href="http://meme-suite.org/doc/spamo.html?man_type=web">manual</a>]</dd>
</dl>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_download">
<p>Download your motif as a position weight matrix or a custom logo.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motif_positives">
<p># positive sequences matching the motif / # positive sequences.</p>
<p>Note these counts are made after erasing sites that match previously
        found motifs.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motif_negatives">
<p># negative sequences matching the motif / # negative sequences.</p>
<p>Note these counts are made after erasing sites that match previously
        found motifs.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motif_pvalue">
<p>The p-value of Fisher's Exact Test for enrichment of the motif in 
        the positive sequences.</p>
<p>Note that the counts used in Fisher's Exact Test are made after 
        erasing sites that match previously found motifs.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motif_evalue">
<p>The E-value is the motif p-value times the number of candidate motifs 
        tested.</p>
<p>Note that the p-value was calculated with counts made after 
        erasing sites that match previously found motifs.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motif_uevalue">
<p>The E-value of the motif calculated without erasing the sites of 
        previously found motifs.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_match_word">
<p>All words matching the motif whose uncorrected p-value is less than
        0.01.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_match_pos">
<p># positive sequences with matches to the word / # positive sequences.</p>
<p>Note these counts are made after erasing sites that match previously
        found motifs.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_match_neg">
<p># negative sequences with matches to the word / # negative sequences.</p>
<p>Note these counts are made after erasing sites that match previously
        found motifs.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_match_pval">
<p>The p-value of Fisher's Exact Test for enrichment of the word in 
        the positive sequences.</p>
<p>Note that the counts used in Fisher's Exact Test are made after 
        erasing sites that match previously found motifs.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_match_eval">
<p>The word p-value times the number of candidates tested.</p>
<p>Note that the p-value was calculated with counts made after 
        erasing sites that match previously found motifs.</p>
<div style="float:right; bottom:0px;">[<a href="javascript:help()">close</a> ]</div>
</div>
<div id="expanded_motif" style="display:none"><div class="box expanded_motif" style="margin-bottom:5px;">
<div>
<div style="float:left"><h2 class="mainh" style="margin:0; padding:0;">
<span class="num"></span>.  
              <span class="name"></span>
</h2></div>
<div style="float:right; "><div class="close" onclick="contract(this);" title="Show less information.">↥</div></div>
<div style="clear:both"></div>
</div>
<div style="padding:0 5px;">
<div style="float:left;">
<img class="img_nc" onerror="fix_expanded_logo(this, false)"><img class="img_rc" onerror="fix_expanded_logo(this, true)">
</div>
<div style="float:right; height:100px;">
<div onclick="send_to_popup2(this);" class="actionbutton" title="Submit this motif to another MEME Suite program.">
<div style="float:left; margin-right:1em;">Submit</div>
<div style="float:right">⇢</div>
<div style="clear:both;"></div>
</div>
<div onclick="download_popup2(this);" class="actionbutton" title="Download this motif as a position weight matrix or a custom logo.">
<div style="float:left; margin-right:1em;">Download</div>
<div style="float:right">⟱</div>
<div style="clear:both;"></div>
</div>
</div>
<div style="clear:both;"></div>
</div>
<h4>Details</h4>
<table class="details">
<thead><tr>
<th>Positives <div class="help" onclick="help(this,'pop_motif_positives')"></div>
</th>
<th>Negatives <div class="help" onclick="help(this,'pop_motif_negatives')"></div>
</th>
<th>P-value <div class="help" onclick="help(this,'pop_motif_pvalue')"></div>
</th>
<th>E-value <div class="help" onclick="help(this,'pop_motif_evalue')"></div>
</th>
<th>Unerased E-value <div class="help" onclick="help(this,'pop_motif_uevalue')"></div>
</th>
</tr></thead>
<tbody><tr>
<td>
<span class="positives"></span>/3206</td>
<td>
<span class="negatives"></span>/4628</td>
<td class="pvalue"></td>
<td class="evalue"></td>
<td class="uevalue"></td>
</tr></tbody>
</table>
<h4>Enriched Matching Words</h4>
<table>
<thead><tr>
<th>
<a href="javascript:;" onclick="sort_table(this, compare_strings)"><span class="sort_dir"></span>Word</a> 
                <div class="help" onclick="help(this,'pop_match_word')"></div>
</th>
<th>
<a href="javascript:;" onclick="sort_table(this, compare_counts)"><span class="sort_dir"></span>Positives</a> 
                <div class="help" onclick="help(this,'pop_match_pos')"></div>
</th>
<th>
<a href="javascript:;" onclick="sort_table(this, compare_counts)"><span class="sort_dir"></span>Negatives</a> 
                <div class="help" onclick="help(this,'pop_match_neg')"></div>
</th>
<th>
<a href="javascript:;" onclick="sort_table(this, compare_numbers)"><span class="sort_dir"></span>P-value</a> 
                <div class="help" onclick="help(this,'pop_match_pval')"></div>
</th>
<th>
<a href="javascript:;" onclick="sort_table(this, compare_numbers)"><span class="sort_dir">▼</span>E-value</a> 
                <div class="help" onclick="help(this,'pop_match_eval')"></div>
</th>
</tr></thead>
<tbody><tr class="match">
<td class="dnaseq"></td>
<td>
<span class="positives"></span>/3206</td>
<td>
<span class="negatives"></span>/4628</td>
<td class="pvalue"></td>
<td class="evalue"></td>
</tr></tbody>
</table>
</div></div>
<div id="grey_out_page" class="grey_background" style="display:none;"></div>
<div class="popup_wrapper"><div id="send_to" class="popup" style="top:-150px; display:none">
<div>
<div style="float:left" id="send_to_title_1"><h2 class="mainh compact">Submit "<span id="send_to_name"></span>"</h2></div>
<div style="float:left" id="send_to_title_2"><h2 class="mainh compact">Submit All Motifs</h2></div>
<div style="float:right; "><div class="close" onclick="both_hide();">x</div></div>
<div style="clear:both"></div>
</div>
<div style="padding:0 5px 5px 5px;">
<div id="send_to_selector" style="height:100px;">
<img id="send_to_img" height="90" style="max-width:170px;" onerror="fix_popup_logo(this, 'send_to_can', false)"><canvas id="send_to_can" width="10" height="100" style="display:none;"></canvas><img id="send_to_rcimg" height="90" style="max-width:170px;" onerror="fix_popup_logo(this, 'send_to_rccan', true);"><canvas id="send_to_rccan" width="10" height="100" style="display:none"></canvas><div style="float:right;">
<a id="prev_arrow_2" href="javascript:both_change(-1)" class="navarrow">⇧</a><div id="pop_num_2" class="navnum"></div>
<a id="next_arrow_2" href="javascript:both_change(1)" class="navarrow">⇩</a>
</div>
</div>
<form>
<div style="">
<div style="float:left;">
<h4 class="compact">Select what you want to do</h4>
<div class="programs_scroll"><ul id="tasks" class="programs">
<li id="search_motifs" onclick="click_submit_task(this)" class="selected">Search Motifs</li>
<li id="search_sequences" onclick="click_submit_task(this)">Search Sequences</li>
<li id="rank_sequences" onclick="click_submit_task(this)">Rank Sequences</li>
<li id="predict_go" onclick="click_submit_task(this)">Predict Gene Ontology terms</li>
<li id="infer_tf" onclick="click_submit_task(this)">Infer TF Complexes</li>
</ul></div>
</div>
<div style="float:right;">
<h4 class="compact">Select a program</h4>
<div class="programs_scroll"><ul id="programs" class="programs">
<li id="TOMTOM" onclick="click_submit_program(this)" class="selected">Tomtom</li>
<li id="FIMO" onclick="click_submit_program(this)">FIMO</li>
<li id="MAST" onclick="click_submit_program(this)">MAST</li>
<li id="GOMO" onclick="click_submit_program(this)">GOMO</li>
<li id="SPAMO" onclick="click_submit_program(this)">SpaMo</li>
</ul></div>
</div>
<div style="font-weight:bold; display:inline-block; text-align:center; width:60px; height:100px; line-height:100px">Or</div>
<div style="clear:both;"></div>
</div>
<h4>
<span id="program_action">Search Motifs</span> with <span id="program_name">Tomtom</span>
</h4>
<p><span id="program_desc">Find similar motifs in published 
                libraries or a library you supply.</span></p>
<div style="margin-top:10px; height: 2em;">
<div style="float:left;"><input type="button" value="Send" onclick="javascript:send_to_submit()"></div>
<div style="float:right;"><input type="button" value="Cancel" onclick="javascript:both_hide()"></div>
</div>
</form>
</div>
</div></div>
<div class="popup_wrapper"><div id="download" class="popup" style="top:-150px; display:none">
<div>
<div style="float:left"><h2 class="mainh" style="margin:0; padding:0;">Download "<span id="download_name"></span>"</h2></div>
<div style="float:right; "><div class="close" onclick="both_hide();">x</div></div>
<div style="clear:both"></div>
</div>
<div style="padding:0 5px 5px 5px;">
<div style="height:100px">
<img id="download_img" height="90" style="max-width:170px;" onerror="fix_popup_logo(this, 'download_can', false)"><canvas id="download_can" width="10" height="100" style="display:none;"></canvas><img id="download_rcimg" height="90" style="max-width:170px;" onerror="fix_popup_logo(this, 'download_rccan', true)"><canvas id="download_rccan" width="10" height="100" style="display:none;"></canvas><div style="float:right;">
<a id="prev_arrow_1" href="javascript:both_change(-1)" class="navarrow">⇧</a><div id="pop_num_1" class="navnum"></div>
<a id="next_arrow_1" href="javascript:both_change(1)" class="navarrow">⇩</a>
</div>
</div>
<form>
<input type="hidden" id="download_tab_num" value="1"><div style="padding:5px 0;">
<div class="tabArea top">
<a id="download_tab_1" href="javascript:click_download_tab(1)" class="tab activeTab">PSPM Format</a><a id="download_tab_2" href="javascript:click_download_tab(2)" class="tab">PSSM Format</a><a id="download_tab_3" href="javascript:click_download_tab(3)" class="tab">Logo</a>
</div>
<div class="tabMain">
<div id="download_pnl_1"><textarea id="download_pspm" style="width:99%" rows="10" readonly></textarea></div>
<div id="download_pnl_2"><textarea id="download_pssm" style="width:99%" rows="10" readonly></textarea></div>
<div id="download_pnl_3"><table>
<tr>
<td><label for="logo_format">Format:</label></td>
<td><select id="logo_format"><option value="png">PNG (for web)</option>
<option value="eps">EPS (for publication)</option></select></td>
</tr>
<tr>
<td><label for="logo_rc">Orientation:</label></td>
<td><select id="logo_rc"><option value="false">Normal</option>
<option value="true">Reverse Complement</option></select></td>
</tr>
<tr>
<td><label for="logo_ssc">Small Sample Correction:</label></td>
<td><select id="logo_ssc"><option value="false">Off</option>
<option value="true">On</option></select></td>
</tr>
<tr>
<td><label for="logo_width">Width:</label></td>
<td>
<input type="text" id="logo_width" size="4"> cm
                      </td>
</tr>
<tr>
<td><label for="logo_height">Height:</label></td>
<td>
<input type="text" id="logo_height" size="4"> cm
                      </td>
</tr>
</table></div>
<div style="margin-top:10px;">
<div style="float:left;"><input type="button" id="download_button" value="Download" style="visibility:hidden;" onclick="javascript:download_submit()"></div>
<div style="float:right;"><input type="button" value="Cancel" onclick="javascript:both_hide()"></div>
<div style="clear:both;"></div>
</div>
</div>
</div>
</form>
</div>
</div></div>
<a name="top"></a><div class="pad1">
<div class="prog_logo big">
<img src="http://meme-suite.org/doc/images/dreme_icon.png" alt="DREME Logo"><h1>DREME</h1>
<h2>Discriminative Regular Expression Motif Elicitation</h2>
</div>
<p class="spaced">
        For further information on how to interpret these results or to get a 
        copy of the MEME software please access 
        <a href="http://meme-suite.org/">http://meme-suite.org</a>. 
      </p>
<p>
        If you use DREME in your research please cite the following paper:<br><span class="citation">
          Timothy L. Bailey, "DREME: Motif discovery in transcription factor ChIP-seq data", <i>Bioinformatics</i>, <b>27</b>(12):1653-1659, 2011.
          <a href="http://bioinformatics.oxfordjournals.org/content/27/12/1653">[full text]</a></span></p>
</div>
<div class="pad2">
<a class="jump" href="#motifs">Discovered motifs</a>  |  <a class="jump" href="#program">Program information</a>
</div>
<a name="motifs"></a><table width="100%" border="0" cellspacing="1" cellpadding="4" bgcolor="#FFFFFF"><tr>
<td><h2 class="mainh">Discovered Motifs</h2></td>
<td align="right" valign="bottom">
<a href="#program">Next</a> <a href="#top">Top</a>
</td>
</tr></table>
<div class="box">
<p><b>Click on the ↧</b> under the <b>More</b> column to show more 
            information about the motif.<br><b>Click on the ⇢</b> under the <b>Submit</b> column to send the 
            motif to another MEME suite program (e.g. Tomtom).<br><b>Click on the ⟱</b> under the <b>Download</b> column to get 
            the position weight matrix of a motif or to download the logo image with
            your chosen options.
          </p>
<table id="dreme_motifs" class="dreme_motifs">
<thead><tr class="motif_head">
<td> </td>
<th>Motif <div class="help" onclick="help(this,'pop_motifs_name')"></div>
</th>
<th>Logo <div class="help" onclick="help(this,'pop_motifs_logo')"></div>
</th>
<th>RC Logo <div class="help" onclick="help(this,'pop_motifs_rc_logo')"></div>
</th>
<th>E-value <div class="help" onclick="help(this,'pop_motifs_evalue')"></div>
</th>
<th>Unerased E-value <div class="help" onclick="help(this,'pop_motifs_uevalue')"></div>
</th>
<th>More <div class="help" onclick="help(this,'pop_more')"></div>
</th>
<th>Submit <div class="help" onclick="help(this,'pop_submit')"></div>
</th>
<th>Download <div class="help" onclick="help(this,'pop_download')"></div>
</th>
</tr></thead>
<tbody>
<tr class="motif_row" id="motif_row_1">
<td>1.</td>
<td>AVAAMAA</td>
<td><img src="m01nc_AVAAMAA.png" id="small_logo_1" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(1, false))"></td>
<td><img src="m01rc_TTKTTBT.png" id="small_rc_logo_1" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(1, true)); true"></td>
<td>3.0e-326</td>
<td>3.0e-284</td>
<td class="symaction"><a href="javascript:expand(1)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(1)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(1)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_2">
<td>2.</td>
<td>BWVAAAA</td>
<td><img src="m02nc_BWVAAAA.png" id="small_logo_2" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(2, false))"></td>
<td><img src="m02rc_TTTTBWV.png" id="small_rc_logo_2" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(2, true)); true"></td>
<td>5.6e-128</td>
<td>1.9e-309</td>
<td class="symaction"><a href="javascript:expand(2)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(2)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(2)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_3">
<td>3.</td>
<td>AARCANW</td>
<td><img src="m03nc_AARCANW.png" id="small_logo_3" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(3, false))"></td>
<td><img src="m03rc_WNTGYTT.png" id="small_rc_logo_3" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(3, true)); true"></td>
<td>1.2e-105</td>
<td>5.6e-212</td>
<td class="symaction"><a href="javascript:expand(3)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(3)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(3)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_4">
<td>4.</td>
<td>ANSAAAR</td>
<td><img src="m04nc_ANSAAAR.png" id="small_logo_4" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(4, false))"></td>
<td><img src="m04rc_YTTTSNT.png" id="small_rc_logo_4" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(4, true)); true"></td>
<td>6.2e-066</td>
<td>7.7e-229</td>
<td class="symaction"><a href="javascript:expand(4)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(4)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(4)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_5">
<td>5.</td>
<td>HTTCWGW</td>
<td><img src="m05nc_HTTCWGW.png" id="small_logo_5" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(5, false))"></td>
<td><img src="m05rc_WCWGAAD.png" id="small_rc_logo_5" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(5, true)); true"></td>
<td>3.3e-056</td>
<td>2.6e-094</td>
<td class="symaction"><a href="javascript:expand(5)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(5)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(5)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_6">
<td>6.</td>
<td>TTTGNAW</td>
<td><img src="m06nc_TTTGNAW.png" id="small_logo_6" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(6, false))"></td>
<td><img src="m06rc_WTNCAAA.png" id="small_rc_logo_6" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(6, true)); true"></td>
<td>4.6e-036</td>
<td>1.2e-063</td>
<td class="symaction"><a href="javascript:expand(6)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(6)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(6)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_7">
<td>7.</td>
<td>AADDTCA</td>
<td><img src="m07nc_AADDTCA.png" id="small_logo_7" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(7, false))"></td>
<td><img src="m07rc_TGAHHTT.png" id="small_rc_logo_7" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(7, true)); true"></td>
<td>7.7e-027</td>
<td>2.3e-076</td>
<td class="symaction"><a href="javascript:expand(7)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(7)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(7)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_8">
<td>8.</td>
<td>AGACADW</td>
<td><img src="m08nc_AGACADW.png" id="small_logo_8" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(8, false))"></td>
<td><img src="m08rc_WHTGTCT.png" id="small_rc_logo_8" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(8, true)); true"></td>
<td>1.0e-024</td>
<td>6.5e-047</td>
<td class="symaction"><a href="javascript:expand(8)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(8)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(8)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_9">
<td>9.</td>
<td>AANWGCA</td>
<td><img src="m09nc_AANWGCA.png" id="small_logo_9" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(9, false))"></td>
<td><img src="m09rc_TGCWNTT.png" id="small_rc_logo_9" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(9, true)); true"></td>
<td>4.0e-027</td>
<td>2.3e-062</td>
<td class="symaction"><a href="javascript:expand(9)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(9)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(9)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_10">
<td>10.</td>
<td>DGAAACW</td>
<td><img src="m10nc_DGAAACW.png" id="small_logo_10" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(10, false))"></td>
<td><img src="m10rc_WGTTTCH.png" id="small_rc_logo_10" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(10, true)); true"></td>
<td>2.1e-022</td>
<td>1.2e-051</td>
<td class="symaction"><a href="javascript:expand(10)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(10)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(10)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_11">
<td>11.</td>
<td>CTHHAAG</td>
<td><img src="m11nc_CTHHAAG.png" id="small_logo_11" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(11, false))"></td>
<td><img src="m11rc_CTTDDAG.png" id="small_rc_logo_11" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(11, true)); true"></td>
<td>1.0e-020</td>
<td>7.3e-030</td>
<td class="symaction"><a href="javascript:expand(11)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(11)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(11)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_12">
<td>12.</td>
<td>HCATTTS</td>
<td><img src="m12nc_HCATTTS.png" id="small_logo_12" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(12, false))"></td>
<td><img src="m12rc_SAAATGD.png" id="small_rc_logo_12" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(12, true)); true"></td>
<td>3.0e-020</td>
<td>1.4e-045</td>
<td class="symaction"><a href="javascript:expand(12)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(12)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(12)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_13">
<td>13.</td>
<td>CWGAGAD</td>
<td><img src="m13nc_CWGAGAD.png" id="small_logo_13" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(13, false))"></td>
<td><img src="m13rc_HTCTCWG.png" id="small_rc_logo_13" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(13, true)); true"></td>
<td>4.2e-021</td>
<td>7.6e-033</td>
<td class="symaction"><a href="javascript:expand(13)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(13)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(13)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_14">
<td>14.</td>
<td>CAKDAAG</td>
<td><img src="m14nc_CAKDAAG.png" id="small_logo_14" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(14, false))"></td>
<td><img src="m14rc_CTTHMTG.png" id="small_rc_logo_14" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(14, true)); true"></td>
<td>6.5e-017</td>
<td>9.2e-035</td>
<td class="symaction"><a href="javascript:expand(14)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(14)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(14)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_15">
<td>15.</td>
<td>ARTNACA</td>
<td><img src="m15nc_ARTNACA.png" id="small_logo_15" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(15, false))"></td>
<td><img src="m15rc_TGTNAYT.png" id="small_rc_logo_15" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(15, true)); true"></td>
<td>1.8e-015</td>
<td>4.6e-041</td>
<td class="symaction"><a href="javascript:expand(15)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(15)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(15)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_16">
<td>16.</td>
<td>CTGTDWA</td>
<td><img src="m16nc_CTGTDWA.png" id="small_logo_16" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(16, false))"></td>
<td><img src="m16rc_TWHACAG.png" id="small_rc_logo_16" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(16, true)); true"></td>
<td>7.3e-016</td>
<td>1.3e-032</td>
<td class="symaction"><a href="javascript:expand(16)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(16)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(16)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_17">
<td>17.</td>
<td>AARTCAD</td>
<td><img src="m17nc_AARTCAD.png" id="small_logo_17" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(17, false))"></td>
<td><img src="m17rc_HTGAYTT.png" id="small_rc_logo_17" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(17, true)); true"></td>
<td>8.0e-014</td>
<td>7.5e-062</td>
<td class="symaction"><a href="javascript:expand(17)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(17)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(17)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_18">
<td>18.</td>
<td>CATTGBW</td>
<td><img src="m18nc_CATTGBW.png" id="small_logo_18" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(18, false))"></td>
<td><img src="m18rc_WVCAATG.png" id="small_rc_logo_18" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(18, true)); true"></td>
<td>1.1e-012</td>
<td>3.8e-025</td>
<td class="symaction"><a href="javascript:expand(18)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(18)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(18)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_19">
<td>19.</td>
<td>ARAACWT</td>
<td><img src="m19nc_ARAACWT.png" id="small_logo_19" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(19, false))"></td>
<td><img src="m19rc_AWGTTYT.png" id="small_rc_logo_19" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(19, true)); true"></td>
<td>4.3e-012</td>
<td>2.0e-051</td>
<td class="symaction"><a href="javascript:expand(19)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(19)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(19)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_20">
<td>20.</td>
<td>TWCTTGW</td>
<td><img src="m20nc_TWCTTGW.png" id="small_logo_20" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(20, false))"></td>
<td><img src="m20rc_WCAAGWA.png" id="small_rc_logo_20" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(20, true)); true"></td>
<td>1.1e-010</td>
<td>1.7e-023</td>
<td class="symaction"><a href="javascript:expand(20)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(20)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(20)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_21">
<td>21.</td>
<td>CTTTSWC</td>
<td><img src="m21nc_CTTTSWC.png" id="small_logo_21" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(21, false))"></td>
<td><img src="m21rc_GWSAAAG.png" id="small_rc_logo_21" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(21, true)); true"></td>
<td>2.3e-009</td>
<td>3.2e-022</td>
<td class="symaction"><a href="javascript:expand(21)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(21)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(21)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_22">
<td>22.</td>
<td>CATGWDA</td>
<td><img src="m22nc_CATGWDA.png" id="small_logo_22" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(22, false))"></td>
<td><img src="m22rc_THWCATG.png" id="small_rc_logo_22" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(22, true)); true"></td>
<td>4.7e-011</td>
<td>5.0e-028</td>
<td class="symaction"><a href="javascript:expand(22)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(22)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(22)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_23">
<td>23.</td>
<td>CTRGAAR</td>
<td><img src="m23nc_CTRGAAR.png" id="small_logo_23" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(23, false))"></td>
<td><img src="m23rc_YTTCYAG.png" id="small_rc_logo_23" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(23, true)); true"></td>
<td>2.0e-010</td>
<td>5.6e-020</td>
<td class="symaction"><a href="javascript:expand(23)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(23)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(23)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_24">
<td>24.</td>
<td>TRMACAA</td>
<td><img src="m24nc_TRMACAA.png" id="small_logo_24" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(24, false))"></td>
<td><img src="m24rc_TTGTKYA.png" id="small_rc_logo_24" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(24, true)); true"></td>
<td>1.5e-009</td>
<td>1.0e-023</td>
<td class="symaction"><a href="javascript:expand(24)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(24)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(24)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_25">
<td>25.</td>
<td>CTTRAGW</td>
<td><img src="m25nc_CTTRAGW.png" id="small_logo_25" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(25, false))"></td>
<td><img src="m25rc_WCTYAAG.png" id="small_rc_logo_25" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(25, true)); true"></td>
<td>2.5e-008</td>
<td>1.8e-015</td>
<td class="symaction"><a href="javascript:expand(25)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(25)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(25)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_26">
<td>26.</td>
<td>AAACSAR</td>
<td><img src="m26nc_AAACSAR.png" id="small_logo_26" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(26, false))"></td>
<td><img src="m26rc_YTSGTTT.png" id="small_rc_logo_26" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(26, true)); true"></td>
<td>2.7e-007</td>
<td>7.4e-021</td>
<td class="symaction"><a href="javascript:expand(26)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(26)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(26)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_27">
<td>27.</td>
<td>CWGATWA</td>
<td><img src="m27nc_CWGATWA.png" id="small_logo_27" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(27, false))"></td>
<td><img src="m27rc_TWATCWG.png" id="small_rc_logo_27" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(27, true)); true"></td>
<td>1.7e-007</td>
<td>1.8e-015</td>
<td class="symaction"><a href="javascript:expand(27)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(27)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(27)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_28">
<td>28.</td>
<td>CTMTGTW</td>
<td><img src="m28nc_CTMTGTW.png" id="small_logo_28" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(28, false))"></td>
<td><img src="m28rc_WACAKAG.png" id="small_rc_logo_28" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(28, true)); true"></td>
<td>9.0e-007</td>
<td>1.6e-018</td>
<td class="symaction"><a href="javascript:expand(28)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(28)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(28)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_29">
<td>29.</td>
<td>ARAYTGG</td>
<td><img src="m29nc_ARAYTGG.png" id="small_logo_29" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(29, false))"></td>
<td><img src="m29rc_CCARTYT.png" id="small_rc_logo_29" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(29, true)); true"></td>
<td>2.1e-006</td>
<td>1.1e-014</td>
<td class="symaction"><a href="javascript:expand(29)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(29)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(29)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_30">
<td>30.</td>
<td>AGAAYCW</td>
<td><img src="m30nc_AGAAYCW.png" id="small_logo_30" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(30, false))"></td>
<td><img src="m30rc_WGRTTCT.png" id="small_rc_logo_30" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(30, true)); true"></td>
<td>2.9e-006</td>
<td>1.2e-011</td>
<td class="symaction"><a href="javascript:expand(30)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(30)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(30)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_31">
<td>31.</td>
<td>CCCWCMC</td>
<td><img src="m31nc_CCCWCMC.png" id="small_logo_31" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(31, false))"></td>
<td><img src="m31rc_GKGWGGG.png" id="small_rc_logo_31" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(31, true)); true"></td>
<td>5.3e-006</td>
<td>6.7e-007</td>
<td class="symaction"><a href="javascript:expand(31)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(31)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(31)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_32">
<td>32.</td>
<td>TARCTSA</td>
<td><img src="m32nc_TARCTSA.png" id="small_logo_32" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(32, false))"></td>
<td><img src="m32rc_TSAGYTA.png" id="small_rc_logo_32" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(32, true)); true"></td>
<td>1.5e-005</td>
<td>5.9e-014</td>
<td class="symaction"><a href="javascript:expand(32)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(32)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(32)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_33">
<td>33.</td>
<td>TAAGCTB</td>
<td><img src="m33nc_TAAGCTB.png" id="small_logo_33" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(33, false))"></td>
<td><img src="m33rc_VAGCTTA.png" id="small_rc_logo_33" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(33, true)); true"></td>
<td>3.8e-005</td>
<td>4.6e-007</td>
<td class="symaction"><a href="javascript:expand(33)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(33)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(33)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_34">
<td>34.</td>
<td>TAWWGCA</td>
<td><img src="m34nc_TAWWGCA.png" id="small_logo_34" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(34, false))"></td>
<td><img src="m34rc_TGCWWTA.png" id="small_rc_logo_34" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(34, true)); true"></td>
<td>7.6e-005</td>
<td>4.4e-022</td>
<td class="symaction"><a href="javascript:expand(34)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(34)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(34)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_35">
<td>35.</td>
<td>ACGTDTA</td>
<td><img src="m35nc_ACGTDTA.png" id="small_logo_35" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(35, false))"></td>
<td><img src="m35rc_TAHACGT.png" id="small_rc_logo_35" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(35, true)); true"></td>
<td>8.9e-006</td>
<td>5.5e-007</td>
<td class="symaction"><a href="javascript:expand(35)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(35)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(35)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_36">
<td>36.</td>
<td>AACHCTG</td>
<td><img src="m36nc_AACHCTG.png" id="small_logo_36" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(36, false))"></td>
<td><img src="m36rc_CAGDGTT.png" id="small_rc_logo_36" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(36, true)); true"></td>
<td>1.3e-004</td>
<td>5.2e-010</td>
<td class="symaction"><a href="javascript:expand(36)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(36)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(36)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_37">
<td>37.</td>
<td>VTGGCAW</td>
<td><img src="m37nc_VTGGCAW.png" id="small_logo_37" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(37, false))"></td>
<td><img src="m37rc_WTGCCAB.png" id="small_rc_logo_37" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(37, true)); true"></td>
<td>4.1e-008</td>
<td>7.1e-013</td>
<td class="symaction"><a href="javascript:expand(37)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(37)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(37)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_38">
<td>38.</td>
<td>ASTGCWA</td>
<td><img src="m38nc_ASTGCWA.png" id="small_logo_38" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(38, false))"></td>
<td><img src="m38rc_TWGCAST.png" id="small_rc_logo_38" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(38, true)); true"></td>
<td>5.6e-006</td>
<td>7.0e-013</td>
<td class="symaction"><a href="javascript:expand(38)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(38)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(38)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_39">
<td>39.</td>
<td>CCAANCC</td>
<td><img src="m39nc_CCAANCC.png" id="small_logo_39" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(39, false))"></td>
<td><img src="m39rc_GGNTTGG.png" id="small_rc_logo_39" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(39, true)); true"></td>
<td>2.7e-004</td>
<td>1.2e-004</td>
<td class="symaction"><a href="javascript:expand(39)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(39)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(39)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_40">
<td>40.</td>
<td>CAARTTK</td>
<td><img src="m40nc_CAARTTK.png" id="small_logo_40" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(40, false))"></td>
<td><img src="m40rc_MAAYTTG.png" id="small_rc_logo_40" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(40, true)); true"></td>
<td>7.8e-005</td>
<td>2.6e-027</td>
<td class="symaction"><a href="javascript:expand(40)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(40)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(40)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_41">
<td>41.</td>
<td>ATGWRCA</td>
<td><img src="m41nc_ATGWRCA.png" id="small_logo_41" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(41, false))"></td>
<td><img src="m41rc_TGYWCAT.png" id="small_rc_logo_41" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(41, true)); true"></td>
<td>3.7e-004</td>
<td>8.8e-012</td>
<td class="symaction"><a href="javascript:expand(41)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(41)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(41)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_42">
<td>42.</td>
<td>CCMMAAA</td>
<td><img src="m42nc_CCMMAAA.png" id="small_logo_42" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(42, false))"></td>
<td><img src="m42rc_TTTKKGG.png" id="small_rc_logo_42" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(42, true)); true"></td>
<td>3.5e-003</td>
<td>2.1e-024</td>
<td class="symaction"><a href="javascript:expand(42)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(42)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(42)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_43">
<td>43.</td>
<td>HAAGGCA</td>
<td><img src="m43nc_HAAGGCA.png" id="small_logo_43" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(43, false))"></td>
<td><img src="m43rc_TGCCTTD.png" id="small_rc_logo_43" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(43, true)); true"></td>
<td>7.2e-003</td>
<td>4.2e-004</td>
<td class="symaction"><a href="javascript:expand(43)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(43)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(43)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_44">
<td>44.</td>
<td>CTYTRCC</td>
<td><img src="m44nc_CTYTRCC.png" id="small_logo_44" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(44, false))"></td>
<td><img src="m44rc_GGYARAG.png" id="small_rc_logo_44" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(44, true)); true"></td>
<td>2.0e-004</td>
<td>6.0e-009</td>
<td class="symaction"><a href="javascript:expand(44)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(44)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(44)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_45">
<td>45.</td>
<td>CHTTCAG</td>
<td><img src="m45nc_CHTTCAG.png" id="small_logo_45" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(45, false))"></td>
<td><img src="m45rc_CTGAADG.png" id="small_rc_logo_45" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(45, true)); true"></td>
<td>4.9e-003</td>
<td>5.5e-013</td>
<td class="symaction"><a href="javascript:expand(45)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(45)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(45)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_46">
<td>46.</td>
<td>CAAGATD</td>
<td><img src="m46nc_CAAGATD.png" id="small_logo_46" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(46, false))"></td>
<td><img src="m46rc_HATCTTG.png" id="small_rc_logo_46" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(46, true)); true"></td>
<td>1.8e-002</td>
<td>4.0e-013</td>
<td class="symaction"><a href="javascript:expand(46)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(46)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(46)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_47">
<td>47.</td>
<td>CAGTARA</td>
<td><img src="m47nc_CAGTARA.png" id="small_logo_47" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(47, false))"></td>
<td><img src="m47rc_TYTACTG.png" id="small_rc_logo_47" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(47, true)); true"></td>
<td>1.8e-002</td>
<td>1.5e-012</td>
<td class="symaction"><a href="javascript:expand(47)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(47)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(47)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_48">
<td>48.</td>
<td>ACAATKG</td>
<td><img src="m48nc_ACAATKG.png" id="small_logo_48" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(48, false))"></td>
<td><img src="m48rc_CMATTGT.png" id="small_rc_logo_48" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(48, true)); true"></td>
<td>4.2e-002</td>
<td>2.3e-007</td>
<td class="symaction"><a href="javascript:expand(48)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(48)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(48)">⟱</a></td>
</tr>
<tr class="motif_row" id="motif_row_49">
<td>49.</td>
<td>CTTSGTA</td>
<td><img src="m49nc_CTTSGTA.png" id="small_logo_49" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(49, false))"></td>
<td><img src="m49rc_TACSAAG.png" id="small_rc_logo_49" width="105" height="50" onerror="add_draw_task(this,                          new FixLogoTask(49, true)); true"></td>
<td>4.8e-002</td>
<td>1.3e-003</td>
<td class="symaction"><a href="javascript:expand(49)">↧</a></td>
<td class="symaction"><a href="javascript:send_to_popup(49)">⇢</a></td>
<td class="symaction"><a href="javascript:download_popup(49)">⟱</a></td>
</tr>
</tbody>
<tfoot><tr class="rule">
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
</tr></tfoot>
</table>
<div style="float:left"><div onclick="send_to_popup(0);" class="actionbutton" title="Submit all motifs to another program.">
<div style="float:left; margin-right:1em;">Submit All</div>
<div style="float:right">⇢</div>
<div style="clear:both;"></div>
</div></div>
<div style="clear:both;"></div>
</div>
<a name="program"></a><div class="bar">
<div style="text-align:right;">
<a href="#motifs">Previous</a> <a href="#top">Top</a>
</div>
<div class="subsection">
<a name="version"></a><h5>DREME version</h5>4.10.2 (Release date: Thu Sep 03 15:00:54 2015 -0700)
      </div>
<div class="subsection">
<a name="reference"></a><h5>Reference</h5>
<span class="citation">
          Timothy L. Bailey, "DREME: Motif discovery in transcription factor ChIP-seq data", <i>Bioinformatics</i>, <b>27</b>(12):1653-1659, 2011.
        </span>
</div>
<div class="subsection">
<a name="command"></a><h5>Command line summary</h5>
<textarea rows="5" style="width:100%;" readonly>dreme -p Only_HuR_Clusters.fa -n Only_TTP_And_HuR_TTP_Common_Clusters.fa -mink 7 -maxk 15 -oc OnlyHuRVsOnlyTTPAndHuRTTPCommon</textarea><br>Result calculation took 9 minutes 54.68 seconds<br>
</div>
<a href="javascript:show_hidden('model')" id="model_activator">show model parameters...</a><div class="subsection" id="model_data" style="display:none;">
<h5>Model parameters</h5>
<textarea style="width:100%;" rows="10" readonly>
positives             = name: "Only HuR Clusters", count: "3206", file: "Only_HuR_Clusters.fa", last_mod_date: "Sun Dec 13 15:50:28 MST 2015"
negatives             = name: "Only TTP And HuR TTP Common Clusters", count: "4628", from: "file", file: "Only_TTP_And_HuR_TTP_Common_Clusters.fa", last_mod_date: "Sun Dec 13 15:50:28 MST 2015"
background            = type: "dna", A: "0.298", C: "0.143", G: "0.071", T: "0.488", from: "dataset"
stop                  = evalue: "0.05"
norc                  = FALSE
ngen                  = 100
add_pv_thresh         = 0.01
seed                  = 1
host                  = USMAC1651SBHAN.local
when                  = Sun Dec 13 15:51:46 MST 2015
</textarea>
</div>
<a href="javascript:hide_shown('model')" style="display:none;" id="model_deactivator">hide model parameters...</a>
</div>
<div id="scrollpad"></div>
</body>
</html>
